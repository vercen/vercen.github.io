var Ot=Object.defineProperty;var Ut=Object.getPrototypeOf;var Dt=Reflect.get;var je=e=>{throw TypeError(e)};var Bt=(e,t,r)=>t in e?Ot(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ye=(e,t,r)=>Bt(e,typeof t!="symbol"?t+"":t,r),xe=(e,t,r)=>t.has(e)||je("Cannot "+r);var M=(e,t,r)=>(xe(e,t,"read from private field"),r?r.call(e):t.get(e)),K=(e,t,r)=>t.has(e)?je("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),O=(e,t,r,s)=>(xe(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),Ee=(e,t,r)=>(xe(e,t,"access private method"),r);var He=(e,t,r)=>Dt(Ut(e),r,t);const S=String.raw,Re=new Set(["alnum","alpha","ascii","blank","cntrl","digit","graph","lower","print","punct","space","upper","word","xdigit"]);function Tt(e,t,r){return e.has(t)||e.set(t,r),e.get(t)}function B(e,t){if(!e)throw new Error(t??"Value expected");return e}const C={Alternator:"Alternator",Assertion:"Assertion",Backreference:"Backreference",Character:"Character",CharacterClassClose:"CharacterClassClose",CharacterClassHyphen:"CharacterClassHyphen",CharacterClassIntersector:"CharacterClassIntersector",CharacterClassOpen:"CharacterClassOpen",CharacterSet:"CharacterSet",Directive:"Directive",GroupClose:"GroupClose",GroupOpen:"GroupOpen",Subroutine:"Subroutine",Quantifier:"Quantifier",EscapedNumber:"EscapedNumber"},A={any:"any",digit:"digit",dot:"dot",grapheme:"grapheme",hex:"hex",newline:"newline",posix:"posix",property:"property",space:"space",word:"word"},Oe={flags:"flags",keep:"keep"},_={absent_repeater:"absent_repeater",atomic:"atomic",capturing:"capturing",group:"group",lookahead:"lookahead",lookbehind:"lookbehind"},ne={greedy:"greedy",lazy:"lazy",possessive:"possessive"},Qe=new Map([["a",7],["b",8],["e",27],["f",12],["n",10],["r",13],["t",9],["v",11]]),lt=S`\[\^?`,pt=`c.? | C(?:-.?)?|${S`[pP]\{(?:\^?[-\x20_]*[A-Za-z][-\x20\w]*\})?`}|${S`x[89A-Fa-f]\p{AHex}(?:\\x[89A-Fa-f]\p{AHex})*`}|${S`u(?:\p{AHex}{4})? | x\{[^\}]*\}? | x\p{AHex}{0,2}`}|${S`o\{[^\}]*\}?`}|${S`\d{1,3}`}`,ft=/[?*+][?+]?|\{(?:\d+(?:,\d*)?|,\d+)\}\??/,he=new RegExp(S`
  \\ (?:
    ${pt}
    | [gk]<[^>]*>?
    | [gk]'[^']*'?
    | .
  )
  | \( (?:
    \? (?:
      [:=!>({]
      | <[=!]
      | <[^>]*>
      | '[^']*'
      | ~\|?
      | #(?:[^)\\]|\\.?)*
      | [^:)]*[:)]
    )?
    | \*
  )?
  | ${ft.source}
  | ${lt}
  | .
`.replace(/\s+/g,""),"gsu"),be=new RegExp(S`
  \\ (?:
    ${pt}
    | .
  )
  | \[:(?:\^?\p{Alpha}+|\^):\]
  | ${lt}
  | &&
  | .
`.replace(/\s+/g,""),"gsu");function Vt(e,t={}){const r={flags:"",...t,rules:{captureGroup:!1,singleline:!1,...t.rules}};if(typeof e!="string")throw new Error("String expected as pattern");const s=Jt(r.flags),n=[s.extended],i={captureGroup:r.rules.captureGroup,getCurrentModX:()=>n.at(-1),numOpenGroups:0,popModX(){n.pop()},pushModX(c){n.push(c)},replaceCurrentModX(c){n[n.length-1]=c},singleline:r.rules.singleline};let a=[],o;for(he.lastIndex=0;o=he.exec(e);){const c=zt(i,e,o[0],he.lastIndex);c.tokens?a.push(...c.tokens):c.token&&a.push(c.token),c.lastIndex!==void 0&&(he.lastIndex=c.lastIndex)}const u=[];let l=0;a.forEach(c=>{c.type===C.GroupOpen&&(c.kind===_.capturing?c.number=++l:c.raw==="("&&u.push(c))}),l||u.forEach((c,h)=>{c.kind=_.capturing,c.number=h+1});const p=l||u.length;return a=a.map(c=>c.type===C.EscapedNumber?Yt(c,p):c).flat(),{tokens:a,flags:s}}function zt(e,t,r,s){const[n,i]=r;if(n==="["){const a=Wt(t,r,s);return{tokens:a.tokens,lastIndex:a.lastIndex}}if(n==="\\"){if("AbBGyYzZ".includes(i))return{token:w(C.Assertion,r,{kind:r})};if(/^\\g[<']/.test(r)){if(!/^\\g(?:<[^>]+>|'[^']+')$/.test(r))throw new Error(`Invalid group name "${r}"`);return{token:w(C.Subroutine,r)}}if(/^\\k[<']/.test(r)){if(!/^\\k(?:<[^>]+>|'[^']+')$/.test(r))throw new Error(`Invalid group name "${r}"`);return{token:w(C.Backreference,r)}}if(i==="K")return{token:w(C.Directive,r,{kind:Oe.keep})};if(i==="N"||i==="R")return{token:w(C.CharacterSet,r,{kind:A.newline,negate:i==="N"})};if(i==="O")return{token:w(C.CharacterSet,r,{kind:A.any})};if(i==="X")return{token:w(C.CharacterSet,r,{kind:A.grapheme})};const a=gt(r,{inCharClass:!1});return Array.isArray(a)?{tokens:a}:{token:a}}if(n==="("){if(r==="(*")throw new Error(`Unsupported named callout "${r}"`);if(r==="(?{")throw new Error(`Unsupported callout "${r}"`);if(r.startsWith("(?#")){if(t[s]!==")")throw new Error('Unclosed comment group "(?#"');return{lastIndex:s+1}}if(/^\(\?[-imx]+[:)]$/.test(r))return{token:Qt(r,e)};if(e.pushModX(e.getCurrentModX()),e.numOpenGroups++,r==="("&&!e.captureGroup||r==="(?:")return{token:w(C.GroupOpen,r,{kind:_.group})};if(r==="(?>")return{token:w(C.GroupOpen,r,{kind:_.atomic})};if(r==="(?="||r==="(?!"||r==="(?<="||r==="(?<!")return{token:w(C.GroupOpen,r,{kind:r[2]==="<"?_.lookbehind:_.lookahead,negate:r.endsWith("!")})};if(r==="("&&e.captureGroup||r.startsWith("(?<")&&r.endsWith(">")||r.startsWith("(?'")&&r.endsWith("'")){const a=w(C.GroupOpen,r,{kind:_.capturing});return r!=="("&&(a.name=r.slice(3,-1)),{token:a}}if(r.startsWith("(?~")){if(r==="(?~|")throw new Error(`Unsupported absent function kind "${r}"`);return{token:w(C.GroupOpen,r,{kind:_.absent_repeater})}}throw r==="(?("?new Error(`Unsupported conditional "${r}"`):new Error(`Invalid or unsupported group option "${r}"`)}if(r===")"){if(e.popModX(),e.numOpenGroups--,e.numOpenGroups<0)throw new Error('Unmatched ")"');return{token:w(C.GroupClose,r)}}if(r==="#"&&e.getCurrentModX()){const a=t.indexOf(`
`,s);return{lastIndex:a===-1?t.length:a}}if(/^\s$/.test(r)&&e.getCurrentModX()){const a=/\s+/y;return a.lastIndex=s,{lastIndex:a.exec(t)?a.lastIndex:s}}if(r===".")return{token:w(C.CharacterSet,r,{kind:A.dot})};if(r==="^"||r==="$"){const a=e.singleline?{"^":S`\A`,$:S`\Z`}[r]:r;return{token:w(C.Assertion,r,{kind:a})}}return r==="|"?{token:w(C.Alternator,r)}:ft.test(r)?{token:Xt(r)}:(ht(r),{token:w(C.Character,r,{value:r.codePointAt(0)})})}function Wt(e,t,r){const s=[w(C.CharacterClassOpen,t,{negate:t[1]==="^"})];let n=1,i;for(be.lastIndex=r;i=be.exec(e);){const a=i[0];if(a[0]==="["&&a[1]!==":")n++,s.push(w(C.CharacterClassOpen,a,{negate:a[1]==="^"}));else if(a==="]"){if(s.at(-1).type===C.CharacterClassOpen)s.push(w(C.Character,a,{value:93}));else if(n--,s.push(w(C.CharacterClassClose,a)),!n)break}else{const o=jt(a);Array.isArray(o)?s.push(...o):s.push(o)}}return{tokens:s,lastIndex:be.lastIndex||e.length}}function jt(e){if(e[0]==="\\")return gt(e,{inCharClass:!0});if(e[0]==="["){const t=/\[:(?<negate>\^?)(?<name>[a-z]+):\]/.exec(e);if(!t||!Re.has(t.groups.name))throw new Error(`Invalid POSIX class "${e}"`);return w(C.CharacterSet,e,{kind:A.posix,value:t.groups.name,negate:!!t.groups.negate})}return e==="-"?w(C.CharacterClassHyphen,e):e==="&&"?w(C.CharacterClassIntersector,e):(ht(e),w(C.Character,e,{value:e.codePointAt(0)}))}function gt(e,{inCharClass:t}){const r=e[1];if(r==="c"||r==="C")return Ht(e);if("dDhHsSwW".includes(r))return Zt(e);if(e.startsWith(S`\o{`))throw new Error(`Incomplete, invalid, or unsupported octal code point "${e}"`);if(/^\\[pP]\{/.test(e)){if(e.length===3)throw new Error(`Incomplete or invalid Unicode property "${e}"`);return qt(e)}if(new RegExp("^\\\\x[89A-Fa-f]\\p{AHex}","u").test(e))try{const s=e.split(/\\x/).slice(1).map(a=>parseInt(a,16)),n=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}).decode(new Uint8Array(s)),i=new TextEncoder;return[...n].map(a=>{const o=[...i.encode(a)].map(u=>`\\x${u.toString(16)}`).join("");return w(C.Character,o,{value:a.codePointAt(0)})})}catch{throw new Error(`Multibyte code "${e}" incomplete or invalid in Oniguruma`)}if(r==="u"||r==="x")return w(C.Character,e,{value:Kt(e)});if(Qe.has(r))return w(C.Character,e,{value:Qe.get(r)});if(/\d/.test(r))return w(C.EscapedNumber,e,{inCharClass:t});if(e==="\\")throw new Error(S`Incomplete escape "\"`);if(r==="M")throw new Error(`Unsupported meta "${e}"`);if([...e].length===2)return w(C.Character,e,{value:e.codePointAt(1)});throw new Error(`Unexpected escape "${e}"`)}function w(e,t,r){return{type:e,raw:t,...r}}function Ht(e){const t=e[1]==="c"?e[2]:e[3];if(!t||!/[A-Za-z]/.test(t))throw new Error(`Unsupported control character "${e}"`);return w(C.Character,e,{value:t.toUpperCase().codePointAt(0)-64})}function Qt(e,t){let{on:r,off:s}=/^\(\?(?<on>[imx]*)(?:-(?<off>[-imx]*))?/.exec(e).groups;s??(s="");const n=(t.getCurrentModX()||r.includes("x"))&&!s.includes("x"),i=Xe(r),a=Xe(s),o={};if(i&&(o.enable=i),a&&(o.disable=a),e.endsWith(")"))return t.replaceCurrentModX(n),w(C.Directive,e,{kind:Oe.flags,flags:o});if(e.endsWith(":")){t.pushModX(n),t.numOpenGroups++;const u=w(C.GroupOpen,e,{kind:_.group});return(i||a)&&(u.flags=o),u}throw new Error(`Unexpected flag modifier "${e}"`)}function Xt(e){const t={};if(e[0]==="{"){const{min:r,max:s}=/^\{(?<min>\d*)(?:,(?<max>\d*))?/.exec(e).groups,n=1e5;if(+r>n||+s>n)throw new Error("Quantifier value unsupported in Oniguruma");t.min=+r,t.max=s===void 0?+r:s===""?1/0:+s,t.kind=e.endsWith("?")?ne.lazy:ne.greedy}else t.min=e[0]==="+"?1:0,t.max=e[0]==="?"?1:1/0,t.kind=e[1]==="+"?ne.possessive:e[1]==="?"?ne.lazy:ne.greedy;return w(C.Quantifier,e,t)}function Zt(e){const t=e[1].toLowerCase();return w(C.CharacterSet,e,{kind:{d:A.digit,h:A.hex,s:A.space,w:A.word}[t],negate:e[1]!==t})}function qt(e){const{p:t,neg:r,value:s}=/^\\(?<p>[pP])\{(?<neg>\^?)(?<value>[^}]+)/.exec(e).groups,n=t==="P"&&!r||t==="p"&&!!r;return w(C.CharacterSet,e,{kind:A.property,value:s,negate:n})}function Xe(e){const t={};return e.includes("i")&&(t.ignoreCase=!0),e.includes("m")&&(t.dotAll=!0),e.includes("x")&&(t.extended=!0),Object.keys(t).length?t:null}function Jt(e){if(!/^[imxDPSW]*$/.test(e))throw new Error(`Flags "${e}" includes unsupported value`);const t={ignoreCase:!1,dotAll:!1,extended:!1,digitIsAscii:!1,posixIsAscii:!1,spaceIsAscii:!1,wordIsAscii:!1};for(const r of e)t[{i:"ignoreCase",m:"dotAll",x:"extended",D:"digitIsAscii",P:"posixIsAscii",S:"spaceIsAscii",W:"wordIsAscii"}[r]]=!0;return t}function Kt(e){if(new RegExp("^(?:\\\\u(?!\\p{AHex}{4})|\\\\x(?!\\p{AHex}{1,2}|\\{\\p{AHex}{1,8}\\}))","u").test(e))throw new Error(`Incomplete or invalid escape "${e}"`);const t=e[2]==="{"?new RegExp("^\\\\x\\{\\s*(?<hex>\\p{AHex}+)","u").exec(e).groups.hex:e.slice(2);return parseInt(t,16)}function Yt(e,t){const{raw:r,inCharClass:s}=e,n=r.slice(1);if(!s&&(n!=="0"&&n.length===1||n[0]!=="0"&&+n<=t))return[w(C.Backreference,r)];const i=[],a=n.match(/^[0-7]+|\d/g);for(let o=0;o<a.length;o++){const u=a[o];let l;if(o===0&&u!=="8"&&u!=="9"){if(l=parseInt(u,8),l>127)throw new Error(S`Octal encoded byte above 177 unsupported "${r}"`)}else l=u.codePointAt(0);i.push(w(C.Character,(o===0?"\\":"")+u,{value:l}))}return i}function ht(e){if([...e].length!==1)throw new Error(`Expected "${e}" to be a single code point`)}const f={AbsentFunction:"AbsentFunction",Alternative:"Alternative",Assertion:"Assertion",Backreference:"Backreference",CapturingGroup:"CapturingGroup",Character:"Character",CharacterClass:"CharacterClass",CharacterClassRange:"CharacterClassRange",CharacterSet:"CharacterSet",Directive:"Directive",Flags:"Flags",Group:"Group",LookaroundAssertion:"LookaroundAssertion",Pattern:"Pattern",Quantifier:"Quantifier",Regex:"Regex",Subroutine:"Subroutine",Recursion:"Recursion"},dt={repeater:"repeater"},x={grapheme_boundary:"grapheme_boundary",line_end:"line_end",line_start:"line_start",search_start:"search_start",string_end:"string_end",string_end_newline:"string_end_newline",string_start:"string_start",word_boundary:"word_boundary"},z={union:"union",intersection:"intersection"},b=A,ce=Oe,Me=ne,Z={lookahead:"lookahead",lookbehind:"lookbehind"};function Ct(e,t={}){const r={flags:"",normalizeUnknownPropertyNames:!1,skipBackrefValidation:!1,skipLookbehindValidation:!1,skipPropertyNameValidation:!1,unicodePropertyMap:null,...t,rules:{captureGroup:!1,singleline:!1,...t.rules}},s=Vt(e,{flags:r.flags,rules:{captureGroup:r.rules.captureGroup,singleline:r.rules.singleline}}),n={capturingGroups:[],current:0,hasNumberedRef:!1,namedGroupsByName:new Map,normalizeUnknownPropertyNames:r.normalizeUnknownPropertyNames,parent:null,skipBackrefValidation:r.skipBackrefValidation,skipLookbehindValidation:r.skipLookbehindValidation,skipPropertyNameValidation:r.skipPropertyNameValidation,subroutines:[],token:null,tokens:s.tokens,unicodePropertyMap:r.unicodePropertyMap,walk:i};function i(h,g){const d=s.tokens[n.current];switch(n.parent=h,n.token=d,n.current++,d.type){case C.Alternator:return j();case C.Assertion:return ur(d);case C.Backreference:return er(n);case C.Character:return Ue(d.value,{useLastValid:!!g.isCheckingRangeEnd});case C.CharacterClassHyphen:return tr(n,g);case C.CharacterClassOpen:return rr(n,g);case C.CharacterSet:return nr(n);case C.Directive:return pr(B(ce[d.kind],`Unexpected directive kind "${d.kind}"`),{flags:d.flags});case C.GroupOpen:return sr(n,g);case C.Quantifier:return ar(n);case C.Subroutine:return ir(n);default:throw new Error(`Unexpected token type "${d.type}"`)}}const a=dr(gr(),fr(s.flags));let o=a.pattern.alternatives[0];for(;n.current<s.tokens.length;){const h=i(o,{});h.type===f.Alternative?(a.pattern.alternatives.push(h),o=h):o.elements.push(h)}const{capturingGroups:u,hasNumberedRef:l,namedGroupsByName:p,subroutines:c}=n;if(l&&p.size&&!r.rules.captureGroup)throw new Error("Numbered backref/subroutine not allowed when using named capture");for(const{ref:h}of c)if(typeof h=="number"){if(h>u.length)throw new Error("Subroutine uses a group number that's not defined")}else if(p.has(h)){if(p.get(h).length>1)throw new Error(S`Subroutine uses a duplicate group name "\g<${h}>"`)}else throw new Error(S`Subroutine uses a group name that's not defined "\g<${h}>"`);return a}function er(e){const{raw:t}=e.token,r=/^\\k[<']/.test(t),s=r?t.slice(3,-1):t.slice(1),n=(i,a=!1)=>{const o=e.capturingGroups.length;let u=!1;if(i>o)if(e.skipBackrefValidation)u=!0;else throw new Error(`Not enough capturing groups defined to the left "${t}"`);return e.hasNumberedRef=!0,Fe(a?o+1-i:i,{orphan:u})};if(r){const i=/^(?<sign>-?)0*(?<num>[1-9]\d*)$/.exec(s);if(i)return n(+i.groups.num,!!i.groups.sign);if(/[-+]/.test(s))throw new Error(`Invalid backref name "${t}"`);if(!e.namedGroupsByName.has(s))throw new Error(`Group name not defined to the left "${t}"`);return Fe(s)}return n(+s)}function tr(e,t){const{parent:r,tokens:s,walk:n}=e,i=r.elements.at(-1),a=s[e.current];if(!t.isCheckingRangeEnd&&i&&i.type!==f.CharacterClass&&i.type!==f.CharacterClassRange&&a&&a.type!==C.CharacterClassOpen&&a.type!==C.CharacterClassClose&&a.type!==C.CharacterClassIntersector){const o=n(r,{...t,isCheckingRangeEnd:!0});if(i.type===f.Character&&o.type===f.Character)return r.elements.pop(),lr(i,o);throw new Error("Invalid character class range")}return Ue(45)}function rr(e,t){const{token:r,tokens:s,walk:n}=e,i=s[e.current],a=[Ce()];let o=Ze(i);for(;o.type!==C.CharacterClassClose;){if(o.type===C.CharacterClassIntersector)a.push(Ce()),e.current++;else{const l=a.at(-1);l.elements.push(n(l,t))}o=Ze(s[e.current],i)}const u=Ce({negate:r.negate});return a.length===1?u.elements=a[0].elements:(u.kind=z.intersection,u.elements=a.map(l=>l.elements.length===1?l.elements[0]:l)),e.current++,u}function nr({token:e,normalizeUnknownPropertyNames:t,skipPropertyNameValidation:r,unicodePropertyMap:s}){let{kind:n,negate:i,value:a}=e;if(n===A.property){const o=we(a);if(Re.has(o)&&!(s!=null&&s.has(o)))n=A.posix,a=o;else return se(a,{negate:i,normalizeUnknownPropertyNames:t,skipPropertyNameValidation:r,unicodePropertyMap:s})}return n===A.posix?hr(a,{negate:i}):Ne(n,{negate:i})}function sr(e,t){const{token:r,tokens:s,capturingGroups:n,namedGroupsByName:i,skipLookbehindValidation:a,walk:o}=e;let u=cr(r);const l=u.type===f.AbsentFunction,p=u.kind===Z.lookbehind,c=p&&u.negate;if(u.type===f.CapturingGroup&&(n.push(u),u.name&&Tt(i,u.name,[]).push(u)),l&&t.isInAbsentFunction)throw new Error("Nested absent function not supported by Oniguruma");let h=qe(s[e.current]);for(;h.type!==C.GroupClose;){if(h.type===C.Alternator)u.alternatives.push(j()),e.current++;else{const g=u.alternatives.at(-1),d=o(g,{...t,isInAbsentFunction:t.isInAbsentFunction||l,isInLookbehind:t.isInLookbehind||p,isInNegLookbehind:t.isInNegLookbehind||c});if(g.elements.push(d),(p||t.isInLookbehind)&&!a){const k="Lookbehind includes a pattern not allowed by Oniguruma";if(c||t.isInNegLookbehind){if(d.kind===Z.lookahead||d.type===f.CapturingGroup)throw new Error(k)}else if(d.kind===Z.lookahead||d.kind===Z.lookbehind&&d.negate)throw new Error(k)}}h=qe(s[e.current])}return e.current++,u}function ar({token:e,parent:t}){const{min:r,max:s,kind:n}=e,i=t.elements.at(-1);if(!i||i.type===f.Assertion||i.type===f.Directive||i.type===f.LookaroundAssertion)throw new Error("Quantifier requires a repeatable token");const a=kt(i,r,s,B(Me[n],`Unexpected quantifier kind "${n}"`));return t.elements.pop(),a}function ir(e){const{token:t,capturingGroups:r,subroutines:s}=e;let n=t.raw.slice(3,-1);const i=/^(?<sign>[-+]?)0*(?<num>[1-9]\d*)$/.exec(n);if(i){const o=+i.groups.num,u=r.length;if(e.hasNumberedRef=!0,n={"":o,"+":u+o,"-":u+1-o}[i.groups.sign],n<1)throw new Error("Invalid subroutine number")}else n==="0"&&(n=0);const a=Cr(n);return s.push(a),a}function or(e){return{type:f.AbsentFunction,kind:e,alternatives:[j()]}}function j(){return{type:f.Alternative,elements:[]}}function mt(e,t){const r={type:f.Assertion,kind:e};return(e===x.word_boundary||e===x.grapheme_boundary)&&(r.negate=!!(t!=null&&t.negate)),r}function ur({kind:e}){return mt(B({"^":x.line_start,$:x.line_end,"\\A":x.string_start,"\\b":x.word_boundary,"\\B":x.word_boundary,"\\G":x.search_start,"\\y":x.grapheme_boundary,"\\Y":x.grapheme_boundary,"\\z":x.string_end,"\\Z":x.string_end_newline}[e],`Unexpected assertion kind "${e}"`),{negate:e===S`\B`||e===S`\Y`})}function Fe(e,t){const r=!!(t!=null&&t.orphan);return{type:f.Backreference,ref:e,...r&&{orphan:r}}}function cr({flags:e,kind:t,name:r,negate:s,number:n}){switch(t){case _.absent_repeater:return or(dt.repeater);case _.atomic:return U({atomic:!0});case _.capturing:return wt(n,r);case _.group:return U({flags:e});case _.lookahead:case _.lookbehind:return le({behind:t===_.lookbehind,negate:s});default:throw new Error(`Unexpected group kind "${t}"`)}}function wt(e,t){const r=t!==void 0;if(r&&!mr(t))throw new Error(`Group name "${t}" invalid in Oniguruma`);return{type:f.CapturingGroup,number:e,...r&&{name:t},alternatives:[j()]}}function Ue(e,t){const r={useLastValid:!1,...t};if(e>1114111){const s=e.toString(16);if(r.useLastValid)e=1114111;else throw e>1310719?new Error(`Invalid code point out of range "\\x{${s}}"`):new Error(`Invalid code point out of range in JS "\\x{${s}}"`)}return{type:f.Character,value:e}}function Ce(e){const t={kind:z.union,negate:!1,...e};return{type:f.CharacterClass,kind:t.kind,negate:t.negate,elements:[]}}function lr(e,t){if(t.value<e.value)throw new Error("Character class range out of order");return{type:f.CharacterClassRange,min:e,max:t}}function Ne(e,t){const r=!!(t!=null&&t.negate),s={type:f.CharacterSet,kind:B(b[e],`Unexpected character set kind "${e}"`)};return(e===A.digit||e===A.hex||e===A.newline||e===A.space||e===A.word)&&(s.negate=r),(e===A.grapheme||e===A.newline&&!r)&&(s.variableLength=!0),s}function pr(e,t){const r={type:f.Directive,kind:e};return e===ce.flags&&(r.flags=t.flags),r}function fr(e){return{type:f.Flags,...e}}function U(e){const t=e==null?void 0:e.atomic,r=e==null?void 0:e.flags;return{type:f.Group,...t&&{atomic:t},...r&&{flags:r},alternatives:[j()]}}function le(e){const t={behind:!1,negate:!1,...e};return{type:f.LookaroundAssertion,kind:t.behind?Z.lookbehind:Z.lookahead,negate:t.negate,alternatives:[j()]}}function gr(){return{type:f.Pattern,alternatives:[j()]}}function hr(e,t){const r=!!(t!=null&&t.negate);if(!Re.has(e))throw new Error(`Invalid POSIX class "${e}"`);return{type:f.CharacterSet,kind:b.posix,value:e,negate:r}}function kt(e,t,r,s=Me.greedy){const n={type:f.Quantifier,min:t,max:r,kind:s,element:e};return r<t?{...n,min:r,max:t,kind:Me.possessive}:n}function dr(e,t){return{type:f.Regex,pattern:e,flags:t}}function Cr(e){return{type:f.Subroutine,ref:e}}function se(e,t){var n;const r={negate:!1,normalizeUnknownPropertyNames:!1,skipPropertyNameValidation:!1,unicodePropertyMap:null,...t};let s=(n=r.unicodePropertyMap)==null?void 0:n.get(we(e));if(!s){if(r.normalizeUnknownPropertyNames)s=wr(e);else if(r.unicodePropertyMap&&!r.skipPropertyNameValidation)throw new Error(S`Invalid Unicode property "\p{${e}}"`)}return{type:f.CharacterSet,kind:b.property,value:s??e,negate:r.negate}}function mr(e){return/^[\p{Alpha}\p{Pc}][^)]*$/u.test(e)}function wr(e){return e.trim().replace(/[- _]+/g,"_").replace(/[A-Z][a-z]+(?=[A-Z])/g,"$&_").replace(/[A-Za-z]+/g,t=>t[0].toUpperCase()+t.slice(1).toLowerCase())}function we(e){return e.replace(/[- _]+/g,"").toLowerCase()}function Ze(e,t){return B(e,`${(t==null?void 0:t.value)===93?"Empty":"Unclosed"} character class`)}function qe(e){return B(e,"Unclosed group")}const De=String.raw,Je=De`(?:\p{Emoji}\uFE0F\u20E3?|\p{Emoji_Modifier_Base}\p{Emoji_Modifier}?|\p{Emoji_Presentation})`,Ke=De`\u{E0061}-\u{E007A}`,kr=()=>new RegExp(De`[\u{1F1E6}-\u{1F1FF}]{2}|\u{1F3F4}[${Ke}]{2}[\u{E0030}-\u{E0039}${Ke}]{1,3}\u{E007F}|${Je}(?:\u200D${Je})*`,"gu");function pe(e,t,r=null){function s(i,a){for(let o=0;o<i.length;o++){const u=n(i[o],a,o,i);o=Math.max(-1,o+u)}}function n(i,a=null,o=null,u=null){var F,N;const l="Container expected";let p=0,c=!1;const h={node:i,parent:a,key:o,container:u,root:e,remove(){B(u,l).splice(Math.max(0,o+p),1),p--,c=!0},removeAllNextSiblings(){return B(u,l).splice(o+1)},removeAllPrevSiblings(){const $=o+p;return p-=$,B(u,l).splice(0,Math.max(0,$))},replaceWith($,I={}){const L=!!I.traverse;u?u[Math.max(0,o+p)]=$:a[o]=$,L&&n($,a,o,u),c=!0},replaceWithMultiple($,I={}){const L=!!I.traverse;if(B(u,l).splice(Math.max(0,o+p),1,...$),p+=$.length-1,L){let J=0;for(let R=0;R<$.length;R++)J+=n($[R],a,o+R+J,u)}c=!0},skip(){c=!0}},g=t["*"],d=t[i.type],k=typeof g=="function"?g:g==null?void 0:g.enter,E=typeof d=="function"?d:d==null?void 0:d.enter;if(k==null||k(h,r),E==null||E(h,r),!c)switch(i.type){case f.Regex:n(i.pattern,i,"pattern"),n(i.flags,i,"flags");break;case f.Alternative:case f.CharacterClass:s(i.elements,i);break;case f.Assertion:case f.Backreference:case f.Character:case f.CharacterSet:case f.Directive:case f.Flags:case f.Recursion:case f.Subroutine:break;case f.AbsentFunction:case f.CapturingGroup:case f.Group:case f.Pattern:s(i.alternatives,i);break;case f.CharacterClassRange:n(i.min,i,"min"),n(i.max,i,"max");break;case f.LookaroundAssertion:s(i.alternatives,i);break;case f.Quantifier:n(i.element,i,"element");break;default:throw new Error(`Unexpected node type "${i.type}"`)}return(F=g==null?void 0:g.exit)==null||F.call(g,h,r),(N=d==null?void 0:d.exit)==null||N.call(d,h,r),p}n(e)}const yr=String.raw`\(\?(?:[:=!>A-Za-z\-]|<[=!]|\(DEFINE\))`;function xr(e,t){for(let r=0;r<e.length;r++)e[r]>=t&&e[r]++}function Er(e,t,r,s){return e.slice(0,t)+s+e.slice(t+r.length)}const P=Object.freeze({DEFAULT:"DEFAULT",CHAR_CLASS:"CHAR_CLASS"});function Be(e,t,r,s){const n=new RegExp(String.raw`${t}|(?<$skip>\[\^?|\\?.)`,"gsu"),i=[!1];let a=0,o="";for(const u of e.matchAll(n)){const{0:l,groups:{$skip:p}}=u;if(!p&&(!s||s===P.DEFAULT==!a)){r instanceof Function?o+=r(u,{context:a?P.CHAR_CLASS:P.DEFAULT,negated:i[i.length-1]}):o+=r;continue}l[0]==="["?(a++,i.push(l[1]==="^")):l==="]"&&a&&(a--,i.pop()),o+=l}return o}function yt(e,t,r,s){Be(e,t,r,s)}function br(e,t,r=0,s){if(!new RegExp(t,"su").test(e))return null;const n=new RegExp(`${t}|(?<$skip>\\\\?.)`,"gsu");n.lastIndex=r;let i=0,a;for(;a=n.exec(e);){const{0:o,groups:{$skip:u}}=a;if(!u&&(!s||s===P.DEFAULT==!i))return a;o==="["?i++:o==="]"&&i&&i--,n.lastIndex==a.index&&n.lastIndex++}return null}function de(e,t,r){return!!br(e,t,0,r)}function $r(e,t){const r=/\\?./gsu;r.lastIndex=t;let s=e.length,n=0,i=1,a;for(;a=r.exec(e);){const[o]=a;if(o==="[")n++;else if(n)o==="]"&&n--;else if(o==="(")i++;else if(o===")"&&(i--,!i)){s=a.index;break}}return e.slice(t,s)}const Ye=new RegExp(String.raw`(?<noncapturingStart>${yr})|(?<capturingStart>\((?:\?<[^>]+>)?)|\\?.`,"gsu");function Ar(e,t){const r=(t==null?void 0:t.hiddenCaptures)??[];let s=(t==null?void 0:t.captureTransfers)??new Map;if(!/\(\?>/.test(e))return{pattern:e,captureTransfers:s,hiddenCaptures:r};const n="(?>",i="(?:(?=(",a=[0],o=[];let u=0,l=0,p=NaN,c;do{c=!1;let h=0,g=0,d=!1,k;for(Ye.lastIndex=Number.isNaN(p)?0:p+i.length;k=Ye.exec(e);){const{0:E,index:F,groups:{capturingStart:N,noncapturingStart:$}}=k;if(E==="[")h++;else if(h)E==="]"&&h--;else if(E===n&&!d)p=F,d=!0;else if(d&&$)g++;else if(N)d?g++:(u++,a.push(u+l));else if(E===")"&&d){if(!g){l++;const I=u+l;if(e=`${e.slice(0,p)}${i}${e.slice(p+n.length,F)}))<$$${I}>)${e.slice(F+1)}`,c=!0,o.push(I),xr(r,I),s.size){const L=new Map;s.forEach((J,R)=>{L.set(R>=I?R+1:R,J.map(re=>re>=I?re+1:re))}),s=L}break}g--}}}while(c);return r.push(...o),e=Be(e,String.raw`\\(?<backrefNum>[1-9]\d*)|<\$\$(?<wrappedBackrefNum>\d+)>`,({0:h,groups:{backrefNum:g,wrappedBackrefNum:d}})=>{if(g){const k=+g;if(k>a.length-1)throw new Error(`Backref "${h}" greater than number of captures`);return`\\${a[k]}`}return`\\${d}`},P.DEFAULT),{pattern:e,captureTransfers:s,hiddenCaptures:r}}const xt=String.raw`(?:[?*+]|\{\d+(?:,\d*)?\})`,$e=new RegExp(String.raw`
\\(?: \d+
  | c[A-Za-z]
  | [gk]<[^>]+>
  | [pPu]\{[^\}]+\}
  | u[A-Fa-f\d]{4}
  | x[A-Fa-f\d]{2}
  )
| \((?: \? (?: [:=!>]
  | <(?:[=!]|[^>]+>)
  | [A-Za-z\-]+:
  | \(DEFINE\)
  ))?
| (?<qBase>${xt})(?<qMod>[?+]?)(?<invalidQ>[?*+\{]?)
| \\?.
`.replace(/\s+/g,""),"gsu");function vr(e){if(!new RegExp(`${xt}\\+`).test(e))return{pattern:e};const t=[];let r=null,s=null,n="",i=0,a;for($e.lastIndex=0;a=$e.exec(e);){const{0:o,index:u,groups:{qBase:l,qMod:p,invalidQ:c}}=a;if(o==="[")i||(s=u),i++;else if(o==="]")i?i--:s=null;else if(!i)if(p==="+"&&n&&!n.startsWith("(")){if(c)throw new Error(`Invalid quantifier "${o}"`);let h=-1;if(/^\{\d+\}$/.test(l))e=Er(e,u+l.length,p,"");else{if(n===")"||n==="]"){const g=n===")"?r:s;if(g===null)throw new Error(`Invalid unmatched "${n}"`);e=`${e.slice(0,g)}(?>${e.slice(g,u)}${l})${e.slice(u+o.length)}`}else e=`${e.slice(0,u-n.length)}(?>${n}${l})${e.slice(u+o.length)}`;h+=4}$e.lastIndex+=h}else o[0]==="("?t.push(u):o===")"&&(r=t.length?t.pop():null);n=o}return{pattern:e}}const G=String.raw,Sr=G`\\g<(?<gRNameOrNum>[^>&]+)&R=(?<gRDepth>[^>]+)>`,Ge=G`\(\?R=(?<rDepth>[^\)]+)\)|${Sr}`,ke=G`\(\?<(?![=!])(?<captureName>[^>]+)>`,Et=G`${ke}|(?<unnamed>\()(?!\?)`,Y=new RegExp(G`${ke}|${Ge}|\(\?|\\?.`,"gsu"),Ae="Cannot use multiple overlapping recursions";function Ir(e,t){const{hiddenCaptures:r,mode:s}={hiddenCaptures:[],mode:"plugin",...t};let n=(t==null?void 0:t.captureTransfers)??new Map;if(!new RegExp(Ge,"su").test(e))return{pattern:e,captureTransfers:n,hiddenCaptures:r};if(s==="plugin"&&de(e,G`\(\?\(DEFINE\)`,P.DEFAULT))throw new Error("DEFINE groups cannot be used with recursion");const i=[],a=de(e,G`\\[1-9]`,P.DEFAULT),o=new Map,u=[];let l=!1,p=0,c=0,h;for(Y.lastIndex=0;h=Y.exec(e);){const{0:g,groups:{captureName:d,rDepth:k,gRNameOrNum:E,gRDepth:F}}=h;if(g==="[")p++;else if(p)g==="]"&&p--;else if(k){if(et(k),l)throw new Error(Ae);if(a)throw new Error(`${s==="external"?"Backrefs":"Numbered backrefs"} cannot be used with global recursion`);const N=e.slice(0,h.index),$=e.slice(Y.lastIndex);if(de($,Ge,P.DEFAULT))throw new Error(Ae);const I=+k-1;e=tt(N,$,I,!1,r,i,c),n=nt(n,N,I,i.length,0,c);break}else if(E){et(F);let N=!1;for(const ue of u)if(ue.name===E||ue.num===+E){if(N=!0,ue.hasRecursedWithin)throw new Error(Ae);break}if(!N)throw new Error(G`Recursive \g cannot be used outside the referenced group "${s==="external"?E:G`\g<${E}&R=${F}>`}"`);const $=o.get(E),I=$r(e,$);if(a&&de(I,G`${ke}|\((?!\?)`,P.DEFAULT))throw new Error(`${s==="external"?"Backrefs":"Numbered backrefs"} cannot be used with recursion of capturing groups`);const L=e.slice($,h.index),J=I.slice(L.length+g.length),R=i.length,re=+F-1,We=tt(L,J,re,!0,r,i,c);n=nt(n,L,re,i.length-R,R,c);const Lt=e.slice(0,$),Rt=e.slice($+I.length);e=`${Lt}${We}${Rt}`,Y.lastIndex+=We.length-g.length-L.length-J.length,u.forEach(ue=>ue.hasRecursedWithin=!0),l=!0}else if(d)c++,o.set(String(c),Y.lastIndex),o.set(d,Y.lastIndex),u.push({num:c,name:d});else if(g[0]==="("){const N=g==="(";N&&(c++,o.set(String(c),Y.lastIndex)),u.push(N?{num:c}:{})}else g===")"&&u.pop()}return r.push(...i),{pattern:e,captureTransfers:n,hiddenCaptures:r}}function et(e){const t=`Max depth must be integer between 2 and 100; used ${e}`;if(!/^[1-9]\d*$/.test(e))throw new Error(t);if(e=+e,e<2||e>100)throw new Error(t)}function tt(e,t,r,s,n,i,a){const o=new Set;s&&yt(e+t,ke,({groups:{captureName:l}})=>{o.add(l)},P.DEFAULT);const u=[r,s?o:null,n,i,a];return`${e}${rt(`(?:${e}`,"forward",...u)}(?:)${rt(`${t})`,"backward",...u)}${t}`}function rt(e,t,r,s,n,i,a){const u=p=>t==="forward"?p+2:r-p+2-1;let l="";for(let p=0;p<r;p++){const c=u(p);l+=Be(e,G`${Et}|\\k<(?<backref>[^>]+)>`,({0:h,groups:{captureName:g,unnamed:d,backref:k}})=>{if(k&&s&&!s.has(k))return h;const E=`_$${c}`;if(d||g){const F=a+i.length+1;return i.push(F),_r(n,F),d?h:`(?<${g}${E}>`}return G`\k<${k}${E}>`},P.DEFAULT)}return l}function _r(e,t){for(let r=0;r<e.length;r++)e[r]>=t&&e[r]++}function nt(e,t,r,s,n,i){if(e.size&&s){let a=0;yt(t,Et,()=>a++,P.DEFAULT);const o=i-a+n,u=new Map;return e.forEach((l,p)=>{const c=(s-a*r)/r,h=a*r,g=p>o+a?p+s:p,d=[];for(const k of l)if(k<=o)d.push(k);else if(k>o+a+c)d.push(k+s);else if(k<=o+a)for(let E=0;E<=r;E++)d.push(k+a*E);else for(let E=0;E<=r;E++)d.push(k+h+c*E);u.set(g,d)}),u}return e}var v=String.fromCodePoint,m=String.raw,ie={flagGroups:(()=>{try{new RegExp("(?i:)")}catch{return!1}return!0})(),unicodeSets:(()=>{try{new RegExp("","v")}catch{return!1}return!0})()};ie.literalHyphenIncorrectlyCreatesRange=(()=>{if(!ie.unicodeSets)return!1;try{new RegExp(m`[\d\-a]`,"v")}catch{return!0}return!1})();function me(e,{enable:t,disable:r}){return{dotAll:!(r!=null&&r.dotAll)&&!!(t!=null&&t.dotAll||e.dotAll),ignoreCase:!(r!=null&&r.ignoreCase)&&!!(t!=null&&t.ignoreCase||e.ignoreCase)}}function fe(e,t,r){return e.has(t)||e.set(t,r),e.get(t)}function Pe(e,t){return st[e]>=st[t]}function Mr(e,t){if(!e)throw new Error("Value expected");return e}var st={ES2025:2025,ES2024:2024,ES2018:2018},Fr={auto:"auto",ES2025:"ES2025",ES2024:"ES2024",ES2018:"ES2018"};function bt(e={}){if({}.toString.call(e)!=="[object Object]")throw new Error("Unexpected options");if(e.target!==void 0&&!Fr[e.target])throw new Error(`Unexpected target "${e.target}"`);const t={accuracy:"default",avoidSubclass:!1,flags:"",global:!1,hasIndices:!1,lazyCompileLength:1/0,target:"auto",verbose:!1,...e,rules:{allowOrphanBackrefs:!1,asciiWordBoundaries:!1,captureGroup:!1,recursionLimit:20,singleline:!1,...e.rules}};return t.target==="auto"&&(t.target=ie.flagGroups?"ES2025":ie.unicodeSets?"ES2024":"ES2018"),t}var Nr="[	-\r ]",T=m`[\p{L}\p{M}\p{N}\p{Pc}]`,Gr=new Set([v(304),v(305)]);function $t(e){if(Gr.has(e))return[e];const t=new Set,r=e.toLowerCase(),s=r.toUpperCase(),n=Rr.get(r),i=Pr.get(r),a=Lr.get(r);return[...s].length===1&&t.add(s),a&&t.add(a),n&&t.add(n),t.add(r),i&&t.add(i),[...t]}var Te=new Map(`C Other
Cc Control cntrl
Cf Format
Cn Unassigned
Co Private_Use
Cs Surrogate
L Letter
LC Cased_Letter
Ll Lowercase_Letter
Lm Modifier_Letter
Lo Other_Letter
Lt Titlecase_Letter
Lu Uppercase_Letter
M Mark Combining_Mark
Mc Spacing_Mark
Me Enclosing_Mark
Mn Nonspacing_Mark
N Number
Nd Decimal_Number digit
Nl Letter_Number
No Other_Number
P Punctuation punct
Pc Connector_Punctuation
Pd Dash_Punctuation
Pe Close_Punctuation
Pf Final_Punctuation
Pi Initial_Punctuation
Po Other_Punctuation
Ps Open_Punctuation
S Symbol
Sc Currency_Symbol
Sk Modifier_Symbol
Sm Math_Symbol
So Other_Symbol
Z Separator
Zl Line_Separator
Zp Paragraph_Separator
Zs Space_Separator
ASCII
ASCII_Hex_Digit AHex
Alphabetic Alpha
Any
Assigned
Bidi_Control Bidi_C
Bidi_Mirrored Bidi_M
Case_Ignorable CI
Cased
Changes_When_Casefolded CWCF
Changes_When_Casemapped CWCM
Changes_When_Lowercased CWL
Changes_When_NFKC_Casefolded CWKCF
Changes_When_Titlecased CWT
Changes_When_Uppercased CWU
Dash
Default_Ignorable_Code_Point DI
Deprecated Dep
Diacritic Dia
Emoji
Emoji_Component EComp
Emoji_Modifier EMod
Emoji_Modifier_Base EBase
Emoji_Presentation EPres
Extended_Pictographic ExtPict
Extender Ext
Grapheme_Base Gr_Base
Grapheme_Extend Gr_Ext
Hex_Digit Hex
IDS_Binary_Operator IDSB
IDS_Trinary_Operator IDST
ID_Continue IDC
ID_Start IDS
Ideographic Ideo
Join_Control Join_C
Logical_Order_Exception LOE
Lowercase Lower
Math
Noncharacter_Code_Point NChar
Pattern_Syntax Pat_Syn
Pattern_White_Space Pat_WS
Quotation_Mark QMark
Radical
Regional_Indicator RI
Sentence_Terminal STerm
Soft_Dotted SD
Terminal_Punctuation Term
Unified_Ideograph UIdeo
Uppercase Upper
Variation_Selector VS
White_Space space
XID_Continue XIDC
XID_Start XIDS`.split(/\s/).map(e=>[we(e),e])),Pr=new Map([["s",v(383)],[v(383),"s"]]),Lr=new Map([[v(223),v(7838)],[v(107),v(8490)],[v(229),v(8491)],[v(969),v(8486)]]),Rr=new Map([H(453),H(456),H(459),H(498),...ve(8072,8079),...ve(8088,8095),...ve(8104,8111),H(8124),H(8140),H(8188)]),Or=new Map([["alnum",m`[\p{Alpha}\p{Nd}]`],["alpha",m`\p{Alpha}`],["ascii",m`\p{ASCII}`],["blank",m`[\p{Zs}\t]`],["cntrl",m`\p{Cc}`],["digit",m`\p{Nd}`],["graph",m`[\P{space}&&\P{Cc}&&\P{Cn}&&\P{Cs}]`],["lower",m`\p{Lower}`],["print",m`[[\P{space}&&\P{Cc}&&\P{Cn}&&\P{Cs}]\p{Zs}]`],["punct",m`[\p{P}\p{S}]`],["space",m`\p{space}`],["upper",m`\p{Upper}`],["word",m`[\p{Alpha}\p{M}\p{Nd}\p{Pc}]`],["xdigit",m`\p{AHex}`]]);function Ur(e,t){const r=[];for(let s=e;s<=t;s++)r.push(s);return r}function H(e){const t=v(e);return[t.toLowerCase(),t]}function ve(e,t){return Ur(e,t).map(r=>H(r))}var At=new Set(["Lower","Lowercase","Upper","Uppercase","Ll","Lowercase_Letter","Lt","Titlecase_Letter","Lu","Uppercase_Letter"]);function Dr(e,t){const r={accuracy:"default",asciiWordBoundaries:!1,avoidSubclass:!1,bestEffortTarget:"ES2025",...t};vt(e);const s={accuracy:r.accuracy,asciiWordBoundaries:r.asciiWordBoundaries,avoidSubclass:r.avoidSubclass,flagDirectivesByAlt:new Map,jsGroupNameMap:new Map,minTargetEs2024:Pe(r.bestEffortTarget,"ES2024"),passedLookbehind:!1,strategy:null,subroutineRefMap:new Map,supportedGNodes:new Set,digitIsAscii:e.flags.digitIsAscii,spaceIsAscii:e.flags.spaceIsAscii,wordIsAscii:e.flags.wordIsAscii};pe(e,Br,s);const n={dotAll:e.flags.dotAll,ignoreCase:e.flags.ignoreCase},i={currentFlags:n,prevFlags:null,globalFlags:n,groupOriginByCopy:new Map,groupsByName:new Map,multiplexCapturesToLeftByRef:new Map,openRefs:new Map,reffedNodesByReferencer:new Map,subroutineRefMap:s.subroutineRefMap};pe(e,Tr,i);const a={groupsByName:i.groupsByName,highestOrphanBackref:0,numCapturesToLeft:0,reffedNodesByReferencer:i.reffedNodesByReferencer};return pe(e,Vr,a),e._originMap=i.groupOriginByCopy,e._strategy=s.strategy,e}var Br={AbsentFunction({node:e,parent:t,replaceWith:r}){const{kind:s,alternatives:n}=e;if(s===dt.repeater){const i=V(U(),[oe(le({negate:!0}),n),se("Any")]),a=kt(i,0,1/0);i.parent=a,r(y(V(U(),[a]),t),{traverse:!0})}else throw new Error(`Unexpected absent function kind "${s}"`)},Alternative:{enter({node:e,parent:t,key:r},{flagDirectivesByAlt:s}){const n=e.elements.filter(i=>i.kind===ce.flags);for(let i=r+1;i<t.alternatives.length;i++){const a=t.alternatives[i];fe(s,a,[]).push(...n)}},exit({node:e},{flagDirectivesByAlt:t}){var r;if((r=t.get(e))!=null&&r.length){const s=It(t.get(e));if(s){const n=y(V(U({flags:s}),e.elements),e);e.elements=[n]}}}},Assertion({node:e,parent:t,key:r,container:s,root:n,remove:i,replaceWith:a},o){const{kind:u,negate:l}=e,{asciiWordBoundaries:p,avoidSubclass:c,supportedGNodes:h,wordIsAscii:g}=o;if(u===x.grapheme_boundary)throw new Error(`Unsupported grapheme boundary "\\${l?"Y":"y"}"`);if(u===x.line_end)a(y(D(m`(?=\z|\n)`),t));else if(u===x.line_start)a(y(D(m`(?<=\A|\n(?!\z))`,{skipLookbehindValidation:!0}),t));else if(u===x.search_start)if(h.has(e))n.flags.sticky=!0,i();else{const d=s[r-1];if(d&&Xr(d))a(y(V(le({negate:!0})),t));else{if(c)throw new Error(m`Uses "\G" in a way that requires a subclass`);a(y(mt(x.string_start),t)),o.strategy="clip_search"}}else if(!(u===x.string_end||u===x.string_start))if(u===x.string_end_newline)a(y(D(m`(?=\n?\z)`),t));else if(u===x.word_boundary){if(!g&&!p){const d=`(?:(?<=${T})(?!${T})|(?<!${T})(?=${T}))`,k=`(?:(?<=${T})(?=${T})|(?<!${T})(?!${T}))`;a(y(D(l?k:d),t))}}else throw new Error(`Unexpected assertion kind "${u}"`)},Backreference({node:e},{jsGroupNameMap:t}){let{ref:r}=e;typeof r=="string"&&!Ie(r)&&(r=Se(r,t),e.ref=r)},CapturingGroup({node:e},{jsGroupNameMap:t,subroutineRefMap:r}){let{name:s}=e;s&&!Ie(s)&&(s=Se(s,t),e.name=s),r.set(e.number,e),s&&r.set(s,e)},CharacterClassRange({node:e,parent:t,replaceWith:r}){t.kind===z.intersection&&r(y(oe(Ce(),[e]),t),{traverse:!0})},CharacterSet({node:e,parent:t,replaceWith:r},{accuracy:s,minTargetEs2024:n,digitIsAscii:i,spaceIsAscii:a,wordIsAscii:o}){const{kind:u,negate:l,value:p}=e;if(i&&(u===b.digit||p==="digit")){r(y(Ne(b.digit,{negate:l}),t));return}if(a&&(u===b.space||p==="space")){r(y(_e(D(Nr),l),t));return}if(o&&(u===b.word||p==="word")){r(y(Ne(b.word,{negate:l}),t));return}if(u===b.any)r(y(se("Any"),t));else if(u===b.digit)r(y(se("Nd",{negate:l}),t));else if(u!==b.dot)if(u===b.grapheme){if(s==="strict")throw new Error(m`Use of "\X" requires non-strict accuracy`);const c=n?m`\p{RGI_Emoji}`:kr().source.replace(/\\u\{/g,"\\x{");r(y(D(m`(?>\r\n|${c}|\P{M}\p{M}*)`,{skipPropertyNameValidation:!0}),t))}else if(u===b.hex)r(y(se("AHex",{negate:l}),t));else if(u===b.newline)r(y(D(l?`[^
]`:`(?>\r
?|[
\v\f\u2028\u2029])`),t));else if(u===b.posix)if(!n&&(p==="graph"||p==="print")){if(s==="strict")throw new Error(`POSIX class "${p}" requires min target ES2024 or non-strict accuracy`);let c={graph:"!-~",print:" -~"}[p];l&&(c=`\0-${v(c.codePointAt(0)-1)}${v(c.codePointAt(2)+1)}-􏿿`),r(y(D(`[${c}]`),t))}else r(y(_e(D(Or.get(p)),l),t));else if(u===b.property)Te.has(we(p))||(e.key="sc");else if(u===b.space)r(y(se("space",{negate:l}),t));else if(u===b.word)r(y(_e(D(T),l),t));else throw new Error(`Unexpected character set kind "${u}"`)},Directive({node:e,parent:t,root:r,remove:s,replaceWith:n,removeAllPrevSiblings:i,removeAllNextSiblings:a}){const{kind:o,flags:u}=e;if(o===ce.flags)!u.enable&&!u.disable?s():n(y(V(U({flags:u}),a()),t),{traverse:!0});else if(o===ce.keep){const l=r.pattern.alternatives[0].elements[0],c=Nt(r.pattern,h=>h.type===f.Group)&&l.alternatives.length===1?l:r.pattern;if(t.parent!==c||c.alternatives.length>1)throw new Error(m`Uses "\K" in a way that's unsupported`);n(y(V(le({behind:!0}),i()),t))}else throw new Error(`Unexpected directive kind "${o}"`)},Flags({node:e,parent:t}){if(e.posixIsAscii)throw new Error('Unsupported flag "P"');["digitIsAscii","extended","posixIsAscii","spaceIsAscii","wordIsAscii"].forEach(r=>delete e[r]),Object.assign(e,{global:!1,hasIndices:!1,multiline:!1,sticky:e.sticky??!1}),t.options={disable:{x:!0,n:!0},force:{v:!0}}},Group({node:e}){if(!e.flags)return;const{enable:t,disable:r}=e.flags;t!=null&&t.extended&&delete t.extended,r!=null&&r.extended&&delete r.extended,t!=null&&t.dotAll&&(r!=null&&r.dotAll)&&delete t.dotAll,t!=null&&t.ignoreCase&&(r!=null&&r.ignoreCase)&&delete t.ignoreCase,t&&!Object.keys(t).length&&delete e.flags.enable,r&&!Object.keys(r).length&&delete e.flags.disable,!e.flags.enable&&!e.flags.disable&&delete e.flags},LookaroundAssertion({node:e},t){const{kind:r}=e;r===Z.lookbehind&&(t.passedLookbehind=!0)},Pattern:{enter({node:e},{supportedGNodes:t}){const r=[];let s=!1,n=!1;for(const i of e.alternatives)if(i.elements.length===1&&i.elements[0].kind===x.search_start)i.elements.pop();else{const a=Mt(i.elements);a?(s=!0,Array.isArray(a)?r.push(...a):r.push(a)):n=!0}s&&!n&&r.forEach(i=>t.add(i))},exit(e,{accuracy:t,passedLookbehind:r,strategy:s}){if(t==="strict"&&r&&s)throw new Error(m`Uses "\G" in a way that requires non-strict accuracy`)}},Quantifier({node:e}){if(e.element.type===f.Quantifier){const t=y(V(U(),[e.element]),e);e.element=t}},Subroutine({node:e},{jsGroupNameMap:t}){let{ref:r}=e;typeof r=="string"&&!Ie(r)&&(r=Se(r,t),e.ref=r)}},Tr={Backreference({node:e},{multiplexCapturesToLeftByRef:t,reffedNodesByReferencer:r}){const{orphan:s,ref:n}=e;s||r.set(e,[...t.get(n).map(({node:i})=>i)])},CapturingGroup:{enter({node:e,parent:t,replaceWith:r,skip:s},{groupOriginByCopy:n,groupsByName:i,multiplexCapturesToLeftByRef:a,openRefs:o,reffedNodesByReferencer:u}){const l=n.get(e);if(l&&o.has(e.number)){const c=y(at(e.number),t);u.set(c,o.get(e.number)),r(c);return}o.set(e.number,e),a.set(e.number,[]),e.name&&fe(a,e.name,[]);const p=a.get(e.name??e.number);for(let c=0;c<p.length;c++){const h=p[c];if(l===h.node||l&&l===h.origin||e===h.origin){p.splice(c,1);break}}if(a.get(e.number).push({node:e,origin:l}),e.name&&a.get(e.name).push({node:e,origin:l}),e.name){const c=fe(i,e.name,new Map);let h=!1;if(l)h=!0;else for(const g of c.values())if(!g.hasDuplicateNameToRemove){h=!0;break}i.get(e.name).set(e,{node:e,hasDuplicateNameToRemove:h})}},exit({node:e},{openRefs:t}){t.delete(e.number)}},Group:{enter({node:e},t){t.prevFlags=t.currentFlags,e.flags&&(t.currentFlags=me(t.currentFlags,e.flags))},exit(e,t){t.currentFlags=t.prevFlags}},Recursion({node:e,parent:t},{reffedNodesByReferencer:r}){const{ref:s}=e;let n=t;for(;(n=n.parent)&&!(n.type===f.CapturingGroup&&(n.name===s||n.number===s)););r.set(e,n)},Subroutine({node:e,parent:t,replaceWith:r},s){const{ref:n}=e,i=s.subroutineRefMap.get(n),a=n===0,o=a?at(0):St(i,s.groupOriginByCopy,null);let u=o;if(!a){const l=It(jr(i,c=>c.type===f.Group&&!!c.flags)),p=l?me(s.globalFlags,l):s.globalFlags;zr(p,s.currentFlags)||(u=V(U({flags:Hr(p)}),[o]))}r(y(u,t),{traverse:!a})}},Vr={Backreference({node:e,parent:t,replaceWith:r},s){if(e.orphan){s.highestOrphanBackref=Math.max(s.highestOrphanBackref,e.ref);return}const i=s.reffedNodesByReferencer.get(e).filter(a=>Wr(a,e));if(!i.length)r(y(V(le({negate:!0})),t));else if(i.length>1){const a=i.map(o=>oe(j(),[Fe(o.number)]));r(y(oe(U(),a),t))}else e.ref=i[0].number},CapturingGroup({node:e},t){e.number=++t.numCapturesToLeft,e.name&&t.groupsByName.get(e.name).get(e).hasDuplicateNameToRemove&&delete e.name},Recursion({node:e},t){e.ref!==0&&(e.ref=t.reffedNodesByReferencer.get(e).number)},Regex:{exit({node:e},t){const r=Math.max(t.highestOrphanBackref-t.numCapturesToLeft,0);for(let s=0;s<r;s++){const n=wt();e.pattern.alternatives.at(-1).elements.push(n)}}}};function vt(e){pe(e,{"*"({node:t,parent:r}){t.parent=r}})}function oe(e,t){return t.forEach(r=>r.parent=e),e[Ve(e)]=t,e}function zr(e,t){return e.dotAll===t.dotAll&&e.ignoreCase===t.ignoreCase}function Wr(e,t){let r=t;do{if(r.type===f.Pattern)return!1;if(r.type===f.Alternative)continue;if(r===e)return!1;const s=_t(r.parent);for(const n of s){if(n===r)break;if(n===e||Ft(n,e))return!0}}while(r=r.parent);throw new Error("Unexpected path")}function St(e,t,r,s){const n=Array.isArray(e)?[]:{};for(const[i,a]of Object.entries(e))i==="parent"?n.parent=Array.isArray(r)?s:r:a&&typeof a=="object"?n[i]=St(a,t,n,r):(i==="type"&&a===f.CapturingGroup&&t.set(n,t.get(e)??e),n[i]=a);return n}function at(e){return{type:f.Recursion,ref:e}}function jr(e,t){const r=[];for(;e=e.parent;)(!t||t(e))&&r.push(e);return r}function Se(e,t){if(t.has(e))return t.get(e);const r=`$${t.size}_${e.replace(/^[^$_\p{IDS}]|[^$\u200C\u200D\p{IDC}]/ug,"_")}`;return t.set(e,r),r}function Ve(e){for(const t of["alternatives","elements"])if(e[t])return t;return null}function It(e){const t=["dotAll","ignoreCase"],r={enable:{},disable:{}};return e.forEach(({flags:s})=>{t.forEach(n=>{var i,a;(i=s.enable)!=null&&i[n]&&(delete r.disable[n],r.enable[n]=!0),(a=s.disable)!=null&&a[n]&&(r.disable[n]=!0)})}),Object.keys(r.enable).length||delete r.enable,Object.keys(r.disable).length||delete r.disable,r.enable||r.disable?r:null}function Hr({dotAll:e,ignoreCase:t}){const r={};return(e||t)&&(r.enable={},e&&(r.enable.dotAll=!0),t&&(r.enable.ignoreCase=!0)),(!e||!t)&&(r.disable={},!e&&(r.disable.dotAll=!0),!t&&(r.disable.ignoreCase=!0)),r}function _t(e){if(!e)throw new Error("Node expected");if(e.type===f.Quantifier)return[e.element];const t=Ve(e);return t&&e[t]}function Mt(e){const t=e.find(r=>r.kind===x.search_start||Zr(r,{negate:!1})||!Qr(r));if(!t)return null;if(t.kind===x.search_start)return t;if(t.type===f.LookaroundAssertion)return t.alternatives[0].elements[0];if(t.type===f.CapturingGroup||t.type===f.Group){const r=[];for(const s of t.alternatives){const n=Mt(s.elements);if(!n)return null;Array.isArray(n)?r.push(...n):r.push(n)}return r}return null}function Ft(e,t){const r=_t(e)??[];for(const s of r)if(s===t||Ft(s,t))return!0;return!1}function Nt({alternatives:e},t){return e.length===1&&e[0].elements.length===1&&(!t||t(e[0].elements[0]))}function Qr({type:e}){return e===f.Assertion||e===f.Directive||e===f.LookaroundAssertion}function Xr(e){const t=[f.Character,f.CharacterClass,f.CharacterSet];return t.includes(e.type)||e.type===f.Quantifier&&e.min&&t.includes(e.element.type)}function Zr(e,t){const r={negate:null,...t};return e.type===f.LookaroundAssertion&&(r.negate===null||e.negate===r.negate)&&Nt(e,s=>s.kind===x.search_start)}function Ie(e){return/^[$_\p{IDS}][$\u200C\u200D\p{IDC}]*$/u.test(e)}function D(e,t){const r=Ct(e,{...t,unicodePropertyMap:Te});vt(r);const s=r.pattern.alternatives;return s.length>1||s[0].elements.length>1?oe(U(),s):s[0].elements[0]}function V(e,t){const r=Ve(e);return e[r][0].parent=e,t&&oe(e[r][0],t),e}function _e(e,t){return e.negate=t,e}function y(e,t){return e.parent=t,e}function qr(e,t){const r=bt(t),s=Pe(r.target,"ES2024"),n=Pe(r.target,"ES2025"),i=r.rules.recursionLimit;if(!Number.isInteger(i)||i<2||i>20)throw new Error("Invalid recursionLimit; use 2-20");let a=null,o=null;if(!n){const g=[e.flags.ignoreCase];pe(e,Jr,{getCurrentModI:()=>g.at(-1),popModI(){g.pop()},pushModI(d){g.push(d)},setHasCasedChar(){g.at(-1)?a=!0:o=!0}})}const u={dotAll:e.flags.dotAll,ignoreCase:!!((e.flags.ignoreCase||a)&&!o)};let l=null;const p={accuracy:r.accuracy,appliedGlobalFlags:u,captureMap:new Map,currentFlags:{dotAll:e.flags.dotAll,ignoreCase:e.flags.ignoreCase},inCharClass:!1,lastNode:l,originMap:e._originMap,recursionLimit:i,useAppliedIgnoreCase:!!(!n&&a&&o),useFlagMods:n,useFlagV:s,verbose:r.verbose};function c(g){switch(p.lastNode=l,l=g,g.type){case f.Regex:return{pattern:c(g.pattern),flags:c(g.flags),options:{...g.options}};case f.Alternative:return g.elements.map(c).join("");case f.Assertion:return rn(g);case f.Backreference:return nn(g,p);case f.CapturingGroup:return sn(g,p,c);case f.Character:return an(g,p);case f.CharacterClass:return on(g,p,c);case f.CharacterClassRange:return un(g,p);case f.CharacterSet:return cn(g,p);case f.Flags:return ln(g,p);case f.Group:return pn(g,p,c);case f.LookaroundAssertion:return fn(g,p,c);case f.Pattern:return g.alternatives.map(c).join("|");case f.Quantifier:return c(g.element)+Cn(g);case f.Recursion:return gn(g,p);default:throw new Error(`Unexpected node type "${g.type}"`)}}const h=c(e);return s||(delete h.options.force.v,h.options.disable.v=!0,h.options.unicodeSetsPlugin=null),h._captureTransfers=new Map,h._hiddenCaptures=[],p.captureMap.forEach((g,d)=>{g.hidden&&h._hiddenCaptures.push(d),g.transferTo&&fe(h._captureTransfers,g.transferTo,[]).push(d)}),h}var Jr={"*":{enter({node:e},t){if(ot(e)){const r=t.getCurrentModI();t.pushModI(e.flags?me({ignoreCase:r},e.flags).ignoreCase:r)}},exit({node:e},t){ot(e)&&t.popModI()}},Backreference(e,t){t.setHasCasedChar()},Character({node:e},t){ze(v(e.value))&&t.setHasCasedChar()},CharacterClassRange({node:e,skip:t},r){t(),Gt(e,{firstOnly:!0}).length&&r.setHasCasedChar()},CharacterSet({node:e},t){e.kind===b.property&&At.has(e.value)&&t.setHasCasedChar()}},Kr=new Set(["$","(",")","*","+",".","?","[","\\","]","^","{","|","}"]),Yr=new Set(["-","\\","]","^","["]),en=new Set(["(",")","-","/","[","\\","]","^","{","|","}","!","#","$","%","&","*","+",",",".",":",";","<","=",">","?","@","`","~"]),it=new Map([[9,m`\t`],[10,m`\n`],[11,m`\v`],[12,m`\f`],[13,m`\r`],[8232,m`\u2028`],[8233,m`\u2029`],[65279,m`\uFEFF`]]),tn=new RegExp("^\\p{Cased}$","u");function ze(e){return tn.test(e)}function rn({kind:e,negate:t}){if(e===x.string_end)return"$";if(e===x.string_start)return"^";if(e===x.word_boundary)return t?m`\B`:m`\b`;throw new Error(`Unexpected assertion kind "${e}"`)}function nn({ref:e},t){if(typeof e!="number")throw new Error("Unexpected named backref in transformed AST");if(!t.useFlagMods&&t.accuracy==="strict"&&t.currentFlags.ignoreCase&&!t.captureMap.get(e).ignoreCase)throw new Error("Use of case-insensitive backref to case-sensitive group requires target ES2025 or non-strict accuracy");return"\\"+e}function sn(e,t,r){const{name:s,number:n,alternatives:i}=e,a={ignoreCase:t.currentFlags.ignoreCase},o=t.originMap.get(e);return o&&(a.hidden=!0,n>o.number&&(a.transferTo=o.number)),t.captureMap.set(n,a),`(${s?`?<${s}>`:""}${i.map(r).join("|")})`}function an({value:e},t){const r=v(e),s=ae(e,{escDigit:t.lastNode.type===f.Backreference,inCharClass:t.inCharClass,useFlagV:t.useFlagV});if(s!==r)return s;if(t.useAppliedIgnoreCase&&t.currentFlags.ignoreCase&&ze(r)){const n=$t(r);return t.inCharClass?n.join(""):n.length>1?`[${n.join("")}]`:n[0]}return r}function on(e,t,r){const{kind:s,negate:n,parent:i}=e;let{elements:a}=e;if(s===z.intersection&&!t.useFlagV)throw new Error("Use of class intersection requires min target ES2024");ie.literalHyphenIncorrectlyCreatesRange&&t.useFlagV&&a.some(ut)&&(a=a.filter(l=>!ut(l)),a.push(Ue(45)));const o=()=>`[${n?"^":""}${a.map(r).join(s===z.intersection?"&&":"")}]`;if(!t.inCharClass){if(!t.useFlagV&&!n){const p=a.filter(c=>c.type===f.CharacterClass&&c.kind===z.union&&c.negate);if(p.length){const c=U(),h=c.alternatives[0];return c.parent=i,h.parent=c,a=a.filter(g=>!p.includes(g)),e.elements=a,a.length?(e.parent=h,h.elements.push(e)):c.alternatives.pop(),p.forEach(g=>{const d=j();d.parent=c,g.parent=d,d.elements.push(g),c.alternatives.push(d)}),r(c)}}t.inCharClass=!0;const l=o();return t.inCharClass=!1,l}const u=a[0];if(s===z.union&&!n&&u&&((!t.useFlagV||!t.verbose)&&i.kind===z.union&&!(ie.literalHyphenIncorrectlyCreatesRange&&t.useFlagV)||!t.verbose&&i.kind===z.intersection&&a.length===1&&u.type!==f.CharacterClassRange))return a.map(r).join("");if(!t.useFlagV&&i.type===f.CharacterClass)throw new Error("Use of nested character class requires min target ES2024");return o()}function un(e,t){const r=e.min.value,s=e.max.value,n={escDigit:!1,inCharClass:!0,useFlagV:t.useFlagV},i=ae(r,n),a=ae(s,n),o=new Set;if(t.useAppliedIgnoreCase&&t.currentFlags.ignoreCase){const u=Gt(e);hn(u).forEach(p=>{o.add(Array.isArray(p)?`${ae(p[0],n)}-${ae(p[1],n)}`:ae(p,n))})}return`${i}-${a}${[...o].join("")}`}function cn({kind:e,negate:t,value:r,key:s},n){if(e===b.dot)return n.currentFlags.dotAll?n.appliedGlobalFlags.dotAll||n.useFlagMods?".":"[^]":m`[^\n]`;if(e===b.digit)return t?m`\D`:m`\d`;if(e===b.property){if(n.useAppliedIgnoreCase&&n.currentFlags.ignoreCase&&At.has(r))throw new Error(`Unicode property "${r}" can't be case-insensitive when other chars have specific case`);return`${t?m`\P`:m`\p`}{${s?`${s}=`:""}${r}}`}if(e===b.word)return t?m`\W`:m`\w`;throw new Error(`Unexpected character set kind "${e}"`)}function ln(e,t){return(t.appliedGlobalFlags.ignoreCase?"i":"")+(e.dotAll?"s":"")+(e.sticky?"y":"")}function pn({atomic:e,flags:t,parent:r,alternatives:s},n,i){const a=n.currentFlags;t&&(n.currentFlags=me(a,t));const o=s.map(i).join("|"),u=!n.verbose&&s.length===1&&r.type!==f.Quantifier&&!e&&(!n.useFlagMods||!t)?o:`(?${dn(e,t,n.useFlagMods)}${o})`;return n.currentFlags=a,u}function fn({kind:e,negate:t,alternatives:r},s,n){return`(?${`${e===Z.lookahead?"":"<"}${t?"!":"="}`}${r.map(n).join("|")})`}function gn({ref:e},t){const r=t.recursionLimit;return e===0?`(?R=${r})`:m`\g<${e}&R=${r}>`}function Gt(e,t){const r=!!(t!=null&&t.firstOnly),s=e.min.value,n=e.max.value,i=[];if(s<65&&(n===65535||n>=131071)||s===65536&&n>=131071)return i;for(let a=s;a<=n;a++){const o=v(a);if(!ze(o))continue;const u=$t(o).filter(l=>{const p=l.codePointAt(0);return p<s||p>n});if(u.length&&(i.push(...u),r))break}return i}function ae(e,{escDigit:t,inCharClass:r,useFlagV:s}){if(it.has(e))return it.get(e);if(e<32||e>126&&e<160||e>262143||t&&mn(e))return e>255?`\\u{${e.toString(16).toUpperCase()}}`:`\\x${e.toString(16).toUpperCase().padStart(2,"0")}`;const n=r?s?en:Yr:Kr,i=v(e);return(n.has(i)?"\\":"")+i}function hn(e){const t=e.map(n=>n.codePointAt(0)).sort((n,i)=>n-i),r=[];let s=null;for(let n=0;n<t.length;n++)t[n+1]===t[n]+1?s??(s=t[n]):s===null?r.push(t[n]):(r.push([s,t[n]]),s=null);return r}function dn(e,t,r){if(e)return">";let s="";if(t&&r){const{enable:n,disable:i}=t;s=(n!=null&&n.ignoreCase?"i":"")+(n!=null&&n.dotAll?"s":"")+(i?"-":"")+(i!=null&&i.ignoreCase?"i":"")+(i!=null&&i.dotAll?"s":"")}return`${s}:`}function Cn({min:e,max:t,kind:r}){let s;return!e&&t===1?s="?":!e&&t===1/0?s="*":e===1&&t===1/0?s="+":e===t?s=`{${e}}`:s=`{${e},${t===1/0?"":t}}`,s+{greedy:"",lazy:"?",possessive:"+"}[r]}function ot({type:e}){return e===f.Group||e===f.CapturingGroup||e===f.LookaroundAssertion}function mn(e){return e>47&&e<58}function ut({type:e,value:t}){return e===f.Character&&t===45}var Q,W,ee,X,te,ge,Le,q,wn=(q=class extends RegExp{constructor(r,s,n){var t=(..._n)=>(super(..._n),K(this,ge),K(this,Q,new Map),K(this,W,null),K(this,ee),K(this,X,null),K(this,te,null),ye(this,"rawOptions",{}),this);const i=!!(n!=null&&n.lazyCompile);if(r instanceof RegExp){if(n)throw new Error("Cannot provide options when copying a regexp");const a=r;t(a,s),O(this,ee,a.source),a instanceof q&&(O(this,Q,M(a,Q)),O(this,X,M(a,X)),O(this,te,M(a,te)),this.rawOptions=a.rawOptions)}else{const a={hiddenCaptures:[],strategy:null,transfers:[],...n};t(i?"":r,s),O(this,ee,r),O(this,Q,yn(a.hiddenCaptures,a.transfers)),O(this,te,a.strategy),this.rawOptions=n??{}}i||O(this,W,this)}get source(){return M(this,ee)||"(?:)"}exec(r){if(!M(this,W)){const{lazyCompile:i,...a}=this.rawOptions;O(this,W,new q(M(this,ee),this.flags,a))}const s=this.global||this.sticky,n=this.lastIndex;if(M(this,te)==="clip_search"&&s&&n){this.lastIndex=0;const i=Ee(this,ge,Le).call(this,r.slice(n));return i&&(kn(i,n,r,this.hasIndices),this.lastIndex+=n),i}return Ee(this,ge,Le).call(this,r)}},Q=new WeakMap,W=new WeakMap,ee=new WeakMap,X=new WeakMap,te=new WeakMap,ge=new WeakSet,Le=function(r){M(this,W).lastIndex=this.lastIndex;const s=He(q.prototype,this,"exec").call(M(this,W),r);if(this.lastIndex=M(this,W).lastIndex,!s||!M(this,Q).size)return s;const n=[...s];s.length=1;let i;this.hasIndices&&(i=[...s.indices],s.indices.length=1);const a=[0];for(let o=1;o<n.length;o++){const{hidden:u,transferTo:l}=M(this,Q).get(o)??{};if(u?a.push(null):(a.push(s.length),s.push(n[o]),this.hasIndices&&s.indices.push(i[o])),l&&n[o]!==void 0){const p=Mr(a[l]);if(s[p]=n[o],this.hasIndices&&(s.indices[p]=i[o]),s.groups){M(this,X)||O(this,X,xn(this.source));const c=M(this,X).get(l);c&&(s.groups[c]=n[o],this.hasIndices&&(s.indices.groups[c]=i[o]))}}}return s},q);function kn(e,t,r,s){if(e.index+=t,e.input=r,s){const n=e.indices;for(let a=0;a<n.length;a++){const o=n[a];o&&(n[a]=[o[0]+t,o[1]+t])}const i=n.groups;i&&Object.keys(i).forEach(a=>{const o=i[a];o&&(i[a]=[o[0]+t,o[1]+t])})}}function yn(e,t){const r=new Map;for(const s of e)r.set(s,{hidden:!0});for(const[s,n]of t)for(const i of n)fe(r,i,{}).transferTo=s;return r}function xn(e){const t=/(?<capture>\((?:\?<(?![=!])(?<name>[^>]+)>|(?!\?)))|\\?./gsu,r=new Map;let s=0,n=0,i;for(;i=t.exec(e);){const{0:a,groups:{capture:o,name:u}}=i;a==="["?s++:s?a==="]"&&s--:o&&(n++,u&&r.set(n,u))}return r}function En(e,t){const r=bn(e,t);return r.options?new wn(r.pattern,r.flags,r.options):new RegExp(r.pattern,r.flags)}function bn(e,t){const r=bt(t),s=Ct(e,{flags:r.flags,normalizeUnknownPropertyNames:!0,rules:{captureGroup:r.rules.captureGroup,singleline:r.rules.singleline},skipBackrefValidation:r.rules.allowOrphanBackrefs,unicodePropertyMap:Te}),n=Dr(s,{accuracy:r.accuracy,asciiWordBoundaries:r.rules.asciiWordBoundaries,avoidSubclass:r.avoidSubclass,bestEffortTarget:r.target}),i=qr(n,r),a=Ir(i.pattern,{captureTransfers:i._captureTransfers,hiddenCaptures:i._hiddenCaptures,mode:"external"}),o=vr(a.pattern),u=Ar(o.pattern,{captureTransfers:a.captureTransfers,hiddenCaptures:a.hiddenCaptures}),l={pattern:u.pattern,flags:`${r.hasIndices?"d":""}${r.global?"g":""}${i.flags}${i.options.disable.v?"u":"v"}`};if(r.avoidSubclass){if(r.lazyCompileLength!==1/0)throw new Error("Lazy compilation requires subclass")}else{const p=u.hiddenCaptures.sort((d,k)=>d-k),c=Array.from(u.captureTransfers),h=n._strategy,g=l.pattern.length>=r.lazyCompileLength;(p.length||c.length||h||g)&&(l.options={...p.length&&{hiddenCaptures:p},...c.length&&{transfers:c},...h&&{strategy:h},...g&&{lazyCompile:g}})}return l}const ct=4294967295;class Pt{constructor(t,r={}){ye(this,"regexps");this.patterns=t,this.options=r;const{forgiving:s=!1,cache:n,regexConstructor:i}=r;if(!i)throw new Error("Option `regexConstructor` is not provided");this.regexps=t.map(a=>{if(typeof a!="string")return a;const o=n==null?void 0:n.get(a);if(o){if(o instanceof RegExp)return o;if(s)return null;throw o}try{const u=i(a);return n==null||n.set(a,u),u}catch(u){if(n==null||n.set(a,u),s)return null;throw u}})}findNextMatchSync(t,r,s){const n=typeof t=="string"?t:t.content,i=[];function a(o,u,l=0){return{index:o,captureIndices:u.indices.map(p=>p==null?{start:ct,end:ct,length:0}:{start:p[0]+l,end:p[1]+l,length:p[1]-p[0]})}}for(let o=0;o<this.regexps.length;o++){const u=this.regexps[o];if(u)try{u.lastIndex=r;const l=u.exec(n);if(!l)continue;if(l.index===r)return a(o,l,0);i.push([o,l,0])}catch(l){if(this.options.forgiving)continue;throw l}}if(i.length){const o=Math.min(...i.map(u=>u[1].index));for(const[u,l,p]of i)if(l.index===o)return a(u,l,p)}return null}}function $n(e,t){return En(e,{global:!0,hasIndices:!0,lazyCompileLength:3e3,rules:{allowOrphanBackrefs:!0,asciiWordBoundaries:!0,captureGroup:!0,recursionLimit:5,singleline:!0},...t})}function vn(e={}){const t=Object.assign({target:"auto",cache:new Map},e);return t.regexConstructor||(t.regexConstructor=r=>$n(r,{target:t.target})),{createScanner(r){return new Pt(r,t)},createString(r){return{content:r}}}}function Sn(){const e={cache:new Map,regexConstructor:()=>{throw new Error("JavaScriptRawEngine: only support precompiled grammar")}};return{createScanner(t){return new Pt(t,e)},createString(t){return{content:t}}}}export{Pt as JavaScriptScanner,Sn as createJavaScriptRawEngine,vn as createJavaScriptRegexEngine,$n as defaultJavaScriptRegexConstructor};
