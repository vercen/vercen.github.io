import{_ as z}from"./DxR1PvzZ.js";import{d as U,c as _,f as u,o as n,C as i,V as C,u as t,n as p,W as F,i as M,P as A,a as N,a1 as W,L as Y,_ as I,R as Z,G as j,S as P,U as E,a0 as L,F as T,j as $,a3 as H,m as J,T as K}from"./C9oyRWrv.js";import{f as B,c as Q,a as v,i as X}from"./BeLVWW9-.js";import{u as G}from"./B-Xr10Kq.js";import{q as x}from"./DW_of5Nz.js";import{u as ee,a as te,b as ae}from"./I3EQHM7X.js";import"./C_gm745W.js";import"./Ce-XL9vW.js";const se={class:"article-item"},oe=["datetime","title"],ie=["datetime","title"],ne=U({__name:"Archive",props:{to:{},useUpdated:{type:Boolean},_path:{},title:{},description:{},link:{},date:{},updated:{},published:{},categories:{},tags:{},type:{},image:{},cover_revert:{type:Boolean},hideInfo:{type:Boolean},recommend:{type:[Number,Boolean]},references:{},readingTime:{}},setup(b){const a=b,r=_(()=>a.useUpdated?a.updated:a.date),f=_(()=>r.value?B(new Date(r.value),"MM-dd"):""),S=_(()=>a.date?B(new Date(a.date),Q(a.updated,a.date)?"MM-dd":"yyyy-MM-dd"):"");return(e,k)=>{const d=Y,l=F;return n(),u("li",se,[i("time",{datetime:("getLocaleDatetime"in e?e.getLocaleDatetime:t(v))(t(r)),title:("getLocaleDatetime"in e?e.getLocaleDatetime:t(v))(t(r))},p(t(f)),9,oe),C(l,{class:"article-link gradient-card",to:e.to,title:e.description},{default:M(()=>[i("span",{class:W(["article-title",{"text-story":e.type==="story"}])},p(e.title),3),e.useUpdated&&("isTimeDiffSignificant"in e?e.isTimeDiffSignificant:t(X))(e.date,e.updated)?(n(),u("time",{key:0,class:"aux-date",datetime:("getLocaleDatetime"in e?e.getLocaleDatetime:t(v))(e.date),title:("getLocaleDatetime"in e?e.getLocaleDatetime:t(v))(e.date)},"  "+p(t(S)),9,ie)):A("",!0),e.image?(n(),N(d,{key:1,class:"article-cover",src:e.image,alt:e.title,loading:"lazy"},null,8,["src","alt"])):A("",!0)]),_:1},8,["to","title"])])}}}),re=I(ne,[["__scopeId","data-v-564337ab"]]),le={class:"archive"},de={class:"archive-title"},ce={class:"archive-year"},me={class:"archive-info"},ue={class:"archive-list"},pe=U({__name:"archive",async setup(b){let a,r;const f=Z();j({title:"归档",meta:[{name:"description",content:`${f.title}的所有文章归档。`}]}),f.stats.birthYear,P().setAside(["blog-stats","blog-log"]);const{data:e}=([a,r]=E(()=>G("posts_index",()=>x().only(["_path","categories","image","date","description","readingTime","recommend","title","updated"]).where({_original_dir:{$eq:"/posts"}}).find(),{default:()=>[]})),a=await a,r(),a),{listSorted:k,isAscending:d,sortOrder:l}=ee(e),{category:h,categories:O,listCategorized:R}=te(k),w=_(()=>{const c=Object.entries(ae(R.value,o=>new Date(o[l.value]||0).getFullYear()));return d.value?c:c.reverse()}),V=_(()=>w.value.reduce((c,[o,g])=>{const y=(g==null?void 0:g.reduce((s,m)=>s+m.readingTime.words,0))||0;return c[o]=H(y),c},{}));return(c,o)=>{const g=z,y=re;return n(),u("div",le,[C(g,{"is-ascending":t(d),"onUpdate:isAscending":o[0]||(o[0]=s=>L(d)?d.value=s:null),"sort-order":t(l),"onUpdate:sortOrder":o[1]||(o[1]=s=>L(l)?l.value=s:null),category:t(h),"onUpdate:category":o[2]||(o[2]=s=>L(h)?h.value=s:null),categories:t(O)},null,8,["is-ascending","sort-order","category","categories"]),(n(!0),u(T,null,$(t(w),([s,m])=>(n(),u("div",{key:s,class:"archive-group"},[i("div",de,[i("h2",ce,p(s),1),i("div",me,[i("span",null,p(t(V)[s])+"字",1),i("span",null,p(m==null?void 0:m.length)+"篇",1)])]),i("menu",ue,[C(K,{appear:"",name:"float-in"},{default:M(()=>[(n(!0),u(T,null,$(m,(D,q)=>(n(),N(y,J({key:D._path,ref_for:!0},D,{to:D._path,"use-updated":t(l)==="updated",style:{"--delay":`${q*.03}s`}}),null,16,["to","use-updated","style"]))),128))]),_:2},1024)])]))),128))])}}}),Ce=I(pe,[["__scopeId","data-v-e41a32ac"]]);export{Ce as default};
