{"_path":"/2022/ctf-xupt-skill","_dir":"2022","_draft":false,"_partial":false,"_locale":"","title":"西邮网安技能赛WriteUp","description":"主办方组织能力、办事水平有待提升。自此之后，作者再未参与过 CTF 赛事。","date":"2022-11-05T15:13:52.000Z","updated":"2022-12-04T14:18:50.000Z","image":"https://image.baidu.com/search/down?url=https://mmbiz.qpic.cn/mmbiz_png/9sIibiadwv3fbR2djcvEqTjtOJavT3z9ibWSpuCJ6wj9ejjZz9Dp9l0NoRjRqXjZIibsKORpAk3WFEE4k5r02cdtXQ/640","categories":["代码"],"tags":["大学","CTF"],"readingTime":{"text":"6 min read","minutes":5.36,"time":321600,"words":1072},"body":{"type":"root","children":[{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"前面废话比较多，"},{"type":"element","tag":"a","props":{"href":"#writeup"},"children":[{"type":"text","value":"点此跳过"}]},{"type":"text","value":"。"}]}]},{"type":"element","tag":"h2","props":{"id":"遇到的问题"},"children":[{"type":"text","value":"遇到的问题"}]},{"type":"element","tag":"h3","props":{"id":"_0-比赛报名组队两个队长干瞪眼"},"children":[{"type":"text","value":"0. 比赛报名组队：两个队长干瞪眼"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"比赛为三人一队，报名时可选择创建队伍或者加入他人队伍。创建队伍后，队长可以删除队员，但队长不能解散队伍并加入他人队伍。导致本人在找到“二缺一”的队伍时无法加入，最后草草“孤军奋战”了事。"}]},{"type":"element","tag":"h3","props":{"id":"_1-比赛事项告知只有网安院新生群有真正参与方式"},"children":[{"type":"text","value":"1. 比赛事项告知：只有网安院新生群有真正参与方式"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"本次比赛属于校级比赛，在比赛事项告知一事上，仍有可提升的方面："},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"登记学分、领取奖品"}]},{"type":"text","value":"的事项需要加入“比赛QQ群”，但比赛宣传海报、公众号报名指引文章、第二课堂（学校学分、活动系统）、正式比赛平台（题目、公告）上"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"找不到任何有关“比赛QQ群”的信息"}]},{"type":"text","value":"，导致本人"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"无法跟进后续环节"}]},{"type":"text","value":"。"}]},{"type":"element","tag":"h3","props":{"id":"_2-比赛复盘要收费"},"children":[{"type":"text","value":"2. 比赛复盘：要收费"}]},{"type":"element","tag":"pic","props":{":mirror":"true","src":"https://mmbiz.qpic.cn/mmbiz_png/9sIibiadwv3fbR2djcvEqTjtOJavT3z9ibWlN2DuWkx4QegGN2iaWMibbt3G6xXDRwIHGgBww0ic9OV3hQH2tKlqWiakQ/640","caption":"复盘题目需要付费"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"举办比赛本身需要耗费大量的人力物力财力，比赛依托第三方平台，赛后一个月复盘时收费属于正常现象。"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"本人在答题时只留存了WriteUp，但为了撰写此文章，题目内容均作了回忆，若有偏差，敬请谅解！"}]}]},{"type":"element","tag":"h3","props":{"id":"本人的反思"},"children":[{"type":"text","value":"本人的反思"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"由于本人缺乏参加比赛的经验，遇到很多意料之外的情况，最后在比赛开始三个小时后不再答题。大学中的CTF竞赛一般都有对应的QQ群，后面有如果还有机会参加此类比赛，一定会尽力联系相关人员问清比赛事项。"}]},{"type":"element","tag":"h2","props":{"id":"解题情况"},"children":[{"type":"text","value":"解题情况"}]},{"type":"element","tag":"pic","props":{":mirror":"true","src":"https://mmbiz.qpic.cn/mmbiz_png/9sIibiadwv3fbR2djcvEqTjtOJavT3z9ibWogpgJDsZbfjY6fNmGejeGxUHniawPLkSDFGaLnHVgD39yQnrFvAOhcw/640","caption":"排名"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"赛事设置一等奖1组、二等奖2组、三等奖3组、优秀奖5组，最后一个获奖队伍的排名为34，但由于种种原因，没有参加评奖环节。"}]},{"type":"element","tag":"pic","props":{":mirror":"true","src":"https://mmbiz.qpic.cn/mmbiz_png/9sIibiadwv3fbR2djcvEqTjtOJavT3z9ibWxGHgLN7PvGS0LXvVaQcWJ0Me8HS1qRxqhHv2nodTKLAnlOqga1aAiag/640","caption":"答题"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"比赛每队三人，但由于本人能力有限，在周围没能找到未组队的选手，最后独自一队参加比赛。"}]},{"type":"element","tag":"h2","props":{"id":"writeup"},"children":[{"type":"text","value":"WriteUp"}]},{"type":"element","tag":"h3","props":{"id":"上不了网了"},"children":[{"type":"text","value":"上不了网了"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"题目给出了一个流量包和文本文档："}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"网络被黑客攻击了，有很多异常流量，并且发现了一串文本："}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"_SEWTRL_T1S@N"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"flag被打乱了，顺序藏在流量中"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"使用Wireshark打开下载的流量文件，根据提示，乱序flag的顺序就藏在流量中，筛选出ping命令，发现TTL值与1~13一一对应。"}]},{"type":"element","tag":"pic","props":{":mirror":"true","src":"https://mmbiz.qpic.cn/mmbiz_png/9sIibiadwv3fbR2djcvEqTjtOJavT3z9ibWxlySyBmXib5VYThQWiaLFT1VPqIOvasfeut9hTicBLfyaxXZjLTC1wHqw/640",":zoom":"true"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"按照1~13的顺序将flag连接。"}]},{"type":"element","tag":"pic","props":{":mirror":"true","src":"https://mmbiz.qpic.cn/mmbiz_png/9sIibiadwv3fbR2djcvEqTjtOJavT3z9ibW4L5wiaDtV9XTrnb5T4H8cUT0O6UJoMwP0dLqBrSPicETKBmcrxdX96Yg/640","width":"280px"},"children":[]},{"type":"element","tag":"h3","props":{"id":"broken_mp4"},"children":[{"type":"text","value":"broken_mp4"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"题目给出了一段正常的MP4，和一段损坏并藏有flag的MP4。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"使用十六进制编辑器对比两段视频，损坏视频的文件头有很多元数据都异常。"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"注：手动识别正常文件头部的元数据，并把对应参数填入损坏的视频的相应位置是标准的解题方式，为了节省时间，这里使用了小工具。"}]}]},{"type":"element","tag":"pic","props":{":mirror":"true","src":"https://mmbiz.qpic.cn/mmbiz_png/9sIibiadwv3fbR2djcvEqTjtOJavT3z9ibW4iaHIAwicF2or5nqyoSsPKtQk7OFiaqtDrvQyK7TibCge5AfvMiamvfPsmw/640","caption":"DVR工具"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"使用Digital Video Repair工具，将能正常播放的视频作为样本，修复损坏的视频，得出答案。"}]},{"type":"element","tag":"pic","props":{":mirror":"true","src":"https://mmbiz.qpic.cn/mmbiz_png/9sIibiadwv3fbR2djcvEqTjtOJavT3z9ibWMOicz6JP7UibBgBLB9MLxGiakwficAjgFiaFojRaqDqVnN1vTjTHu0YoS2g/640",":zoom":"true"},"children":[]},{"type":"element","tag":"h3","props":{"id":"双重凯撒"},"children":[{"type":"text","value":"双重凯撒"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"题目给出了加密脚本和加密后的文本，以及提示 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"key为你所在的位置"}]},{"type":"text","value":"。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"根据提示“key为所在的位置”，尝试将西安邮电大学的英文缩写 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"XUPT"}]},{"type":"text","value":" 作为 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"key"}]},{"type":"text","value":"，使用程序加密字符串 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"flag"}]},{"type":"text","value":"，发现与 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"output"}]},{"type":"text","value":" 前四位相同，故 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"key"}]},{"type":"text","value":" 正确。"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"由于此题两层凯撒加密的算法有漏洞，加密后再加密即为解密，故完成本题时没有编写反向计算脚本。"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"根据加密原理，加密后的字符串再次加密可以得到原文，故将 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"output"}]},{"type":"text","value":" 放入程序中再次加密，得到flag。"}]},{"type":"element","tag":"pic","props":{":mirror":"true","src":"https://mmbiz.qpic.cn/mmbiz_png/9sIibiadwv3fbR2djcvEqTjtOJavT3z9ibW6GNrWuOQruKuu8dYldMSrhnG8Ox830RqJibEljz43rIDFptbBetY6Vg/640","caption":"flag"},"children":[]},{"type":"element","tag":"h3","props":{"id":"signin"},"children":[{"type":"text","value":"Signin"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"题目给出了一个 Win32 二进制程序。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"使用 IDA 打开程序，反编译为类 C 代码，得到 flag。"}]},{"type":"element","tag":"pic","props":{":mirror":"true","src":"https://mmbiz.qpic.cn/mmbiz_png/9sIibiadwv3fbR2djcvEqTjtOJavT3z9ibWVHSED0ic7zNcOqkyQPvzcUffZxibIKYhplrVVe05gcUn96qDL8hL6vVw/640",":zoom":"true"},"children":[]},{"type":"element","tag":"h2","props":{"id":"总结"},"children":[{"type":"text","value":"总结"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"由于本人水平有限，许多题目都走了捷径，并且由于各种原因，其他题目也没能解答，这场比赛给我的教训多于成就，在我参加的比赛中属于别具特色的类型。今后的学习中，不止要注重理论技术的学习，还要注意与人的沟通、办事的技巧，这样才能得到真正的成长。"}]}],"toc":{"title":"","searchDepth":4,"depth":4,"links":[{"id":"遇到的问题","depth":2,"text":"遇到的问题","children":[{"id":"_0-比赛报名组队两个队长干瞪眼","depth":3,"text":"0. 比赛报名组队：两个队长干瞪眼"},{"id":"_1-比赛事项告知只有网安院新生群有真正参与方式","depth":3,"text":"1. 比赛事项告知：只有网安院新生群有真正参与方式"},{"id":"_2-比赛复盘要收费","depth":3,"text":"2. 比赛复盘：要收费"},{"id":"本人的反思","depth":3,"text":"本人的反思"}]},{"id":"解题情况","depth":2,"text":"解题情况"},{"id":"writeup","depth":2,"text":"WriteUp","children":[{"id":"上不了网了","depth":3,"text":"上不了网了"},{"id":"broken_mp4","depth":3,"text":"broken_mp4"},{"id":"双重凯撒","depth":3,"text":"双重凯撒"},{"id":"signin","depth":3,"text":"Signin"}]},{"id":"总结","depth":2,"text":"总结"}]}},"_type":"markdown","_id":"content:posts:2022:ctf-xupt-skill.md","_source":"content","_file":"posts/2022/ctf-xupt-skill.md","_stem":"posts/2022/ctf-xupt-skill","_extension":"md","_original_dir":"/posts"}