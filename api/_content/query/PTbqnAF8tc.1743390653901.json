{"_path":"/2024/moonlight-streaming-guide","_dir":"2024","_draft":false,"_partial":false,"_locale":"","title":"Moonlight 串流指南","description":"服务端Sunshine设置、客户端分辨率调整、隐私屏功能实现及触摸优化。","date":"2024-01-18T10:58:55.000Z","updated":"2024-07-08T04:51:35.000Z","image":"https://7.isyangs.cn/24/6664009b8f999-24.jpg","categories":["经验分享"],"tags":["tailscale","moonlight","sunshine","网络","远程","教程"],"references":[{"title":"用 Sunshine + Moonlight 打造带有“隐私模式”的游戏串流服务","link":"https://www.xkww3n.cyou/2023/09/18/sunshine-moonlight-game-streaming-privately/"}],"recommend":50,"readingTime":{"text":"5 min read","minutes":4.97,"time":298200,"words":994},"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"环境"},"children":[{"type":"text","value":"环境"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"和要串流的设备位于同一局域网，如果不是，请尝试使用 Tailscale 或者 Zerotier 进行虚拟组网，参见此教程："}]},{"type":"element","tag":"link-banner","props":{"banner":"https://7.isyangs.cn/24/6664009cce512-24.jpg","link":"/2023/tailscale-incomplete-guide","title":"Tailscale 不完全使用指南"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"你也可以通过 IPv6 进行公网串流，但需要注意，“IPv6临时地址”特性或者防火墙可能会导致无法正常连接。"}]},{"type":"element","tag":"h2","props":{"id":"服务端"},"children":[{"type":"text","value":"服务端"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"如果你是 NVIDIA 显卡，可以使用 GeForce Experience 中的 NVIDIA SHIELD 功能。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"更推荐使用 Sunshine 作为服务端，Sunshine的默认配置可以很好地工作，一般不需要修改。"}]},{"type":"element","tag":"link-card","props":{"icon":"https://docs.lizardbyte.dev/projects/sunshine/en/latest/_static/sunshine.png","link":"https://app.lizardbyte.dev/Sunshine/?lng=zh-CN","title":"Sunshine 官网"},"children":[]},{"type":"element","tag":"h2","props":{"id":"客户端"},"children":[{"type":"text","value":"客户端"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"使用 Moonlight 作为串流的客户端。可以参考B站上阿西西的教程。"}]},{"type":"element","tag":"link-card","props":{"icon":"https://moonlight-stream.org/images/moonlight.svg","link":"https://moonlight-stream.org/","title":"Moonlight 官网"},"children":[]},{"type":"element","tag":"link-card","props":{"icon":"https://github.githubassets.com/favicons/favicon.svg","link":"https://github.com/Axixi2233/moonlight-android","title":"Moonlight Android阿西西修改版"},"children":[]},{"type":"element","tag":"link-card","props":{"icon":"https://i1.hdslb.com/bfs/face/b41566f47ea0d0f1e35ed54521c849c68c026892.jpg@120w","link":"https://space.bilibili.com/16893379/video","title":"阿西西的日常 - 哔哩哔哩",":mirror":"true"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在 Moonlight 客户端中应该可以看到主机，在 Sunshine Web 控制台中输入 PIN 以配对。请在客户端设置中选择"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"合适的串流分辨率"}]},{"type":"text","value":"和帧数。"}]},{"type":"element","tag":"h2","props":{"id":"隐私屏-作为副屏"},"children":[{"type":"text","value":"隐私屏 / 作为副屏"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"通过“虚拟显示器”功能，可以在串流时关闭真实屏幕，从而实现隐私屏。"}]},{"type":"element","tag":"link-card","props":{"icon":"https://www.amyuni.com//images/favicon.png","link":"https://www.amyuni.com/forum/viewtopic.php?t=3030","title":"USB 虚拟显示器驱动"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这个帖子提供了 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"usbmmidd_v2.zip"}]},{"type":"text","value":" 下载。将它解压到一个安全的地方，比如 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"D:\\Software\\"}]},{"type":"text","value":" ，双击 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"usbmmidd.bat"}]},{"type":"text","value":" 安装。"}]},{"type":"element","tag":"h3","props":{"id":"自定义分辨率"},"children":[{"type":"text","value":"自定义分辨率"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"打开注册表，在 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WUDF\\Services\\usbmmIdd\\Parameters\\Monitors"}]},{"type":"text","value":" 中设置虚拟显示器的分辨率，可以给名称为 0~9 的项添加串流客户端的屏幕分辨率为字符串值。"}]},{"type":"element","tag":"h3","props":{"id":"设置隐私屏应用"},"children":[{"type":"text","value":"设置隐私屏应用"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在 Sunshine Web 控制台的“应用程序”标签页中点击 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"+ 添加新应用"}]},{"type":"text","value":"，配置如下："}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"应用名称："},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"隐私串流"}]},{"type":"text","value":"，下方“启动/退出时执行命令”(Command Preparations) 中添加以下命令："}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"启动/退出时执行命令：\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"▶ Do Command"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"↺ Undo Command"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"🛡 Run as Admin"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code","props":{"className":"language-sh shiki shiki-themes catppuccin-latte one-dark-pro","language":"sh","style":""},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E66F5;--shiki-default-font-style:italic;--shiki-dark:#61AFEF;--shiki-dark-font-style:inherit"},"children":[{"type":"text","value":"deviceinstaller64"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#40A02B;--shiki-dark:#98C379"},"children":[{"type":"text","value":" enableidd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FE640B;--shiki-dark:#D19A66"},"children":[{"type":"text","value":" 0"}]}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code","props":{"className":"language-sh shiki shiki-themes catppuccin-latte one-dark-pro","language":"sh","style":""},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E66F5;--shiki-default-font-style:italic;--shiki-dark:#61AFEF;--shiki-dark-font-style:inherit"},"children":[{"type":"text","value":"deviceinstaller64"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#40A02B;--shiki-dark:#98C379"},"children":[{"type":"text","value":" enableidd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FE640B;--shiki-dark:#D19A66"},"children":[{"type":"text","value":" 0"}]}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"☑ Elevated"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code","props":{"className":"language-sh shiki shiki-themes catppuccin-latte one-dark-pro","language":"sh","style":""},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E66F5;--shiki-default-font-style:italic;--shiki-dark:#61AFEF;--shiki-dark-font-style:inherit"},"children":[{"type":"text","value":"deviceinstaller64"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#40A02B;--shiki-dark:#98C379"},"children":[{"type":"text","value":" enableidd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FE640B;--shiki-dark:#D19A66"},"children":[{"type":"text","value":" 1"}]}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code","props":{"className":"language-sh shiki shiki-themes catppuccin-latte one-dark-pro","language":"sh","style":""},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E66F5;--shiki-default-font-style:italic;--shiki-dark:#61AFEF;--shiki-dark-font-style:inherit"},"children":[{"type":"text","value":"deviceinstaller64"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#40A02B;--shiki-dark:#98C379"},"children":[{"type":"text","value":" enableidd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FE640B;--shiki-dark:#D19A66"},"children":[{"type":"text","value":" 0"}]}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"☑ Elevated"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code","props":{"className":"language-sh shiki shiki-themes catppuccin-latte one-dark-pro","language":"sh","style":""},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E66F5;--shiki-default-font-style:italic;--shiki-dark:#61AFEF;--shiki-dark-font-style:inherit"},"children":[{"type":"text","value":"rundll32"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#40A02B;--shiki-dark:#98C379"},"children":[{"type":"text","value":" user32.dll,LockWorkStation"}]}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"☐ Elevated"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code","props":{"className":"language-sh shiki shiki-themes catppuccin-latte one-dark-pro","language":"sh","style":""},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E66F5;--shiki-default-font-style:italic;--shiki-dark:#61AFEF;--shiki-dark-font-style:inherit"},"children":[{"type":"text","value":"DisplaySwitch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#40A02B;--shiki-dark:#98C379"},"children":[{"type":"text","value":" /external"}]}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code","props":{"className":"language-sh shiki shiki-themes catppuccin-latte one-dark-pro","language":"sh","style":""},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E66F5;--shiki-default-font-style:italic;--shiki-dark:#61AFEF;--shiki-dark-font-style:inherit"},"children":[{"type":"text","value":"DisplaySwitch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#40A02B;--shiki-dark:#98C379"},"children":[{"type":"text","value":" /internal"}]}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"☐ Elevated"}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"多执行一次“关闭虚拟显示器”是为了防止虚拟显示器多开导致串流主机分辨率异常且操作卡顿。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":"language-sh shiki shiki-themes catppuccin-latte one-dark-pro","language":"sh","style":""},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E66F5;--shiki-default-font-style:italic;--shiki-dark:#61AFEF;--shiki-dark-font-style:inherit"},"children":[{"type":"text","value":"rundll32"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#40A02B;--shiki-dark:#98C379"},"children":[{"type":"text","value":" user32.dll,LockWorkStation"}]}]},{"type":"text","value":" 是为了在结束串流后锁定电脑。"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"注意，串流暂停或结束后电脑声音将不通过串流设备播放。"}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"工作目录：usbmmidd 解压后所在目录\n"},{"type":"element","tag":"copy","props":{":prompt":"true","code":"D:\\Software\\usbmmidd_v2\\"},"children":[]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"点击“保存”按钮，你应该能看到串流列表里多了刚刚添加的“隐私串流”应用。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"新版会自动获取并切换屏幕，这会导致重连时被切换为主显示器，可以修改如下设置以规避："}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"配置-音频/视频-高级显示设备选项-设备配置-禁用"}]}]},{"type":"element","tag":"h3","props":{"id":"linux-作为服务端使用虚拟副屏"},"children":[{"type":"text","value":"Linux 作为服务端，使用虚拟副屏"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"参考千雪的这篇文章。"}]},{"type":"element","tag":"link-card","props":{"icon":"https://q1.qlogo.cn/g?b=qq&nk=3526514925&s=3","link":"https://blog.chyk.ink/2024/05/12/linux-virtual-display-sunshine/","title":"📲 在 Linux 上使用 Sunshine 把安卓平板作为虚拟副屏，画面清晰延迟极低"},"children":[]},{"type":"element","tag":"h2","props":{"id":"触摸优化"},"children":[{"type":"text","value":"触摸优化"}]},{"type":"element","tag":"h3","props":{"id":"多点触控支持"},"children":[{"type":"text","value":"多点触控支持"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Moonlight 修改版（下载链接在视频简介）支持 Windows 多点触控。"}]},{"type":"element","tag":"link-card","props":{"icon":"https://www.bilibili.com/favicon.ico","link":"https://www.bilibili.com/video/BV1Si4y1Y7Jb/","title":"使用触摸界面串流原神"},"children":[]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"在安卓设置中开启 Moonlight 物理键盘的无障碍功能，即可将安卓设备上的快捷键操作重定向到串流主机上。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"如果想唤出设备输入法键盘，可以在 Moonlight 修改版设置中启用 “快捷选项”。"}]}]},{"type":"element","tag":"h4","props":{"id":"防止多指手势被设备劫持"},"children":[{"type":"text","value":"防止多指手势被设备劫持"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"特别地，在 MIUI / HyperOS 中，可以开启 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"设置 > 桌面 > 系统导航方式 > 屏蔽三指、四指手势"}]},{"type":"text","value":"，并将 Moonlight 添加到 MIUI 游戏加速列表中，在游戏加速设置中选择屏蔽手势、防误触，在单项游戏高级设置中关闭边缘误触抑制。这样做可以让多指手势通过 Moonlight 发送给宿主机，而不是被 MIUI / HyperOS 捕获。其他品牌设备同理。"}]},{"type":"element","tag":"h3","props":{"id":"全屏模式下唤出开始菜单控制中心或任务栏"},"children":[{"type":"text","value":"全屏模式下唤出开始菜单、控制中心或任务栏"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"串流时从屏幕底端中部上划，即可显示开始菜单；从屏幕底端右侧上划，即可显示控制中心；手势被打断后，只显示任务栏。"}]},{"type":"element","tag":"h3","props":{"id":"竖屏串流支持"},"children":[{"type":"text","value":"竖屏串流支持"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"使用 Sunshine Nightly 版本。"}]},{"type":"element","tag":"h3","props":{"id":"使用屏幕键盘"},"children":[{"type":"text","value":"使用屏幕键盘"}]},{"type":"element","tag":"h4","props":{"id":"自动弹出-windows-触摸键盘"},"children":[{"type":"text","value":"自动弹出 Windows 触摸键盘"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"将 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Windows 设置 > 时间和语言 > 输入 > 触摸键盘 > 显示触摸键盘"}]},{"type":"text","value":" 改为 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"始终"}]},{"type":"text","value":"。"}]},{"type":"element","tag":"h4","props":{"id":"在任务栏上显示触摸键盘按钮"},"children":[{"type":"text","value":"在任务栏上显示触摸键盘按钮"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"将 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Windows 设置 > 个性化 > 任务栏 > 系统托盘图标 > 触摸键盘"}]},{"type":"text","value":" 改为 "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"始终"}]},{"type":"text","value":"。"}]},{"type":"element","tag":"h4","props":{"id":"客户端键盘"},"children":[{"type":"text","value":"客户端键盘"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"原版 Moonlight 客户端三指轻触即可呼出设备输入法键盘。"}]},{"type":"element","tag":"h4","props":{"id":"全功能键盘"},"children":[{"type":"text","value":"全功能键盘"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"上文提到的 "},{"type":"element","tag":"a","props":{"href":"#%E8%A7%A6%E6%91%B8%E4%BC%98%E5%8C%96"},"children":[{"type":"text","value":"Moonlight 修改版"}]},{"type":"text","value":" 支持全功能键盘，可以支持更多功能。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"😆享受你的串流体验吧！"}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}"}]}],"toc":{"title":"","searchDepth":4,"depth":4,"links":[{"id":"环境","depth":2,"text":"环境"},{"id":"服务端","depth":2,"text":"服务端"},{"id":"客户端","depth":2,"text":"客户端"},{"id":"隐私屏-作为副屏","depth":2,"text":"隐私屏 / 作为副屏","children":[{"id":"自定义分辨率","depth":3,"text":"自定义分辨率"},{"id":"设置隐私屏应用","depth":3,"text":"设置隐私屏应用"},{"id":"linux-作为服务端使用虚拟副屏","depth":3,"text":"Linux 作为服务端，使用虚拟副屏"}]},{"id":"触摸优化","depth":2,"text":"触摸优化","children":[{"id":"多点触控支持","depth":3,"text":"多点触控支持","children":[{"id":"防止多指手势被设备劫持","depth":4,"text":"防止多指手势被设备劫持"}]},{"id":"全屏模式下唤出开始菜单控制中心或任务栏","depth":3,"text":"全屏模式下唤出开始菜单、控制中心或任务栏"},{"id":"竖屏串流支持","depth":3,"text":"竖屏串流支持"},{"id":"使用屏幕键盘","depth":3,"text":"使用屏幕键盘","children":[{"id":"自动弹出-windows-触摸键盘","depth":4,"text":"自动弹出 Windows 触摸键盘"},{"id":"在任务栏上显示触摸键盘按钮","depth":4,"text":"在任务栏上显示触摸键盘按钮"},{"id":"客户端键盘","depth":4,"text":"客户端键盘"},{"id":"全功能键盘","depth":4,"text":"全功能键盘"}]}]}]}},"_type":"markdown","_id":"content:posts:2024:moonlight-streaming-guide.md","_source":"content","_file":"posts/2024/moonlight-streaming-guide.md","_stem":"posts/2024/moonlight-streaming-guide","_extension":"md","_original_dir":"/posts"}