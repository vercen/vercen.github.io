[{"data":1,"prerenderedAt":181},["ShallowReactive",2],{"/2024/virus-trueupdate":3,"surround-/2024/virus-trueupdate":171},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"date":10,"updated":11,"image":12,"indent":13,"categories":14,"tags":16,"references":21,"readingTime":25,"body":30,"_type":164,"_id":165,"_source":166,"_file":167,"_stem":168,"_extension":169,"_original_dir":170},"/2024/virus-trueupdate","2024",false,"","病毒高占用CPU，三天杀俩","2024年2月两次处理同一病毒导致随机进程名高CPU占用问题，推测源自盗版软件，成功清理TrueUpdate Client引入的相关病毒脚本。","2024-02-29T15:54:43.000Z","2024-03-01T16:09:56.000Z","https://7.isyangs.cn/24/6664009db743b-24.jpg",true,[15],"经验分享",[17,18,19,20],"病毒","Windows","系统","问题",[22],{"title":23,"link":24},"TrueUpdate白加黑木马分析保姆级教程","https://www.cnblogs.com/VxerLee/p/17736138.html",{"text":26,"minutes":27,"time":28,"words":29},"4 min read",3.985,239100,797,{"type":31,"children":32,"toc":155},"root",[33,42,48,53,58,63,68,73,78,83,97,102,115,120,125,130,135,140,145,150],{"type":34,"tag":35,"props":36,"children":38},"element","h2",{"id":37},"随机进程名大量占用cpu",[39],{"type":40,"value":41},"text","随机进程名大量占用CPU",{"type":34,"tag":43,"props":44,"children":45},"p",{},[46],{"type":40,"value":47},"2024年2月26日，一名学弟找到了我，表示自己电脑里有进程大量占用CPU，程序名是由大小写字母、数字组成的随机内容。我询问这是否是自己编写的程序，学弟回答不是，所以判断这个程序有极大可能是病毒。",{"type":34,"tag":43,"props":49,"children":50},{},[51],{"type":40,"value":52},"为了留存记录，我让学弟在任务管理器中右键打开程序所在的目录，拍照并关机。学弟回复打不开路径。",{"type":34,"tag":43,"props":54,"children":55},{},[56],{"type":40,"value":57},"同时，不排除是勒索病毒正在加密文件，所以让学弟立马长按电源键强制断电，并且把笔记本带来实验室检查一下。",{"type":34,"tag":35,"props":59,"children":61},{"id":60},"判断病毒类型",[62],{"type":40,"value":60},{"type":34,"tag":43,"props":64,"children":65},{},[66],{"type":40,"value":67},"学弟带来笔记本以后，顺手就按下了开机键，我连忙打断施法，并且告诉他数据可能会被勒索病毒加密，要做好数据丢失的心理准备。",{"type":34,"tag":43,"props":69,"children":70},{},[71],{"type":40,"value":72},"我在 PE 环境下想要检查文件，但是4个分区都被 BitLocker 加密了。学弟回想了一下电脑里最重要的文件，是电赛的一个文件夹，其他数据都无所谓。所以我在 PE 下把 BitLocker 解密后把这个文件夹打包，并且删除了文件扩展名，以此来绕过潜在的勒索病毒的威胁。",{"type":34,"tag":43,"props":74,"children":75},{},[76],{"type":40,"value":77},"随后正常开机，解锁了 BitLocker ，检查个人文件发现并没有被加密，排除了病毒属于勒索病毒的可能。",{"type":34,"tag":35,"props":79,"children":81},{"id":80},"杀灭程序",[82],{"type":40,"value":80},{"type":34,"tag":43,"props":84,"children":85},{},[86,88,95],{"type":40,"value":87},"进程名是随机字符，所以很有可能是经过复制后的结果。打开任务管理器的进程列表，在网上搜索可能的进程名，发现 ",{"type":34,"tag":89,"props":90,"children":92},"code",{"className":91},[],[93],{"type":40,"value":94},"TrueUpdate Client",{"type":40,"value":96}," 应该是病毒复制的源头。",{"type":34,"tag":43,"props":98,"children":99},{},[100],{"type":40,"value":101},"这个程序存放在了公用用户的文件夹下，删掉。",{"type":34,"tag":43,"props":103,"children":104},{},[105,107,113],{"type":40,"value":106},"再找找被复制的病毒，在 ",{"type":34,"tag":89,"props":108,"children":110},{"className":109},[],[111],{"type":40,"value":112},"C:\\ProgramData\\",{"type":40,"value":114}," 文件夹下复制了不少，删掉。（有些隐藏了，有些设置了权限不容易删除）",{"type":34,"tag":43,"props":116,"children":117},{},[118],{"type":40,"value":119},"计划任务里有不少病毒的自启动任务，删掉。",{"type":34,"tag":35,"props":121,"children":123},{"id":122},"寻找病毒来源",[124],{"type":40,"value":122},{"type":34,"tag":43,"props":126,"children":127},{},[128],{"type":40,"value":129},"在得到学弟的同意之后，我检查了学弟的电脑，想要看看病毒的来源。",{"type":34,"tag":43,"props":131,"children":132},{},[133],{"type":40,"value":134},"学弟的电脑非常干净，只有嵌入式开发相关的软件，连游戏都没有。",{"type":34,"tag":43,"props":136,"children":137},{},[138],{"type":40,"value":139},"在调查了各种软件的安装时间和来源之后，我推测，问题可能起因于从含有病毒脚本的不可靠第三方网站下载 Keil 软件时，不慎引入了恶意程序。还好没有发现病毒破坏文件的迹象，不然重要资料可能就危险了。",{"type":34,"tag":35,"props":141,"children":143},{"id":142},"再见老朋友",[144],{"type":40,"value":142},{"type":34,"tag":43,"props":146,"children":147},{},[148],{"type":40,"value":149},"两天后，我拖着疲惫的身躯回到宿舍时，已经临近熄灯时刻。舍友询问拯救者玩游戏帧数只有几十，我回答是游戏内设置问题，因为他会照着抖音里一些教程修改系统设置。但同时我注意到了电脑空载时，风扇仍然保持最大转速运行，再联想到前天的经历，我打开了他的任务管理器。",{"type":34,"tag":43,"props":151,"children":152},{},[153],{"type":40,"value":154},"果然，又是一台中毒的电脑。",{"title":7,"searchDepth":156,"depth":156,"links":157},4,[158,160,161,162,163],{"id":37,"depth":159,"text":41},2,{"id":60,"depth":159,"text":60},{"id":80,"depth":159,"text":80},{"id":122,"depth":159,"text":122},{"id":142,"depth":159,"text":142},"markdown","content:posts:2024:virus-trueupdate.md","content","posts/2024/virus-trueupdate.md","posts/2024/virus-trueupdate","md","/posts",[172,177],{"_path":173,"title":174,"date":175,"type":176},"/2024/carrier-overbilling","运营商又想多收话费了","2024-02-23T10:32:25.000Z","story",{"_path":178,"title":179,"date":180},"/2024/boot-management","系统引导配置分享","2024-03-01T06:06:19.000Z",1743389902707]