[{"data":1,"prerenderedAt":782},["ShallowReactive",2],{"/2024/linux-samba":3,"surround-/2024/linux-samba":772},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"date":10,"updated":11,"categories":12,"tags":14,"references":19,"readingTime":26,"body":31,"_type":765,"_id":766,"_source":767,"_file":768,"_stem":769,"_extension":770,"_original_dir":771},"/2024/linux-samba","2024",false,"","Linux 下通过 Samba 共享文件夹","Linux 作为 SMB 协议服务器，向其他设备提供共享文件夹服务。","2024-08-04T13:11:03.000Z","2024-09-04T18:04:43.000Z",[13],"经验分享",[15,16,17,18],"教程","archlinux","samba","smb",[20,23],{"title":21,"link":22},"smbpasswd - Samba man page","https://www.samba.org/samba/docs/current/man-html/smbpasswd.8.html",{"title":24,"link":25},"Samba - Arch Linux 中文维基","https://wiki.archlinuxcn.org/wiki/Samba",{"text":27,"minutes":28,"time":29,"words":30},"3 min read",2.44,146400,488,{"type":32,"children":33,"toc":756},"root",[34,42,56,62,91,152,157,164,221,227,335,341,365,370,394,399,738,743,750],{"type":35,"tag":36,"props":37,"children":38},"element","p",{},[39],{"type":40,"value":41},"text","SMB (Server Message Block) 是一种网络文件共享协议；Samba 是在 Linux 上实现 SMB/CIFS 的自由软件服务。",{"type":35,"tag":36,"props":43,"children":44},{},[45,47,54],{"type":40,"value":46},"如果要在 Windows 上使用 SMB 共享文件夹，请参阅 ",{"type":35,"tag":48,"props":49,"children":51},"a",{"href":50},"/2023/tailscale-incomplete-guide",[52],{"type":40,"value":53},"Tailscale 不完全使用指南 # Windows 文件共享",{"type":40,"value":55},"。",{"type":35,"tag":57,"props":58,"children":60},"h2",{"id":59},"简单传输文件",[61],{"type":40,"value":59},{"type":35,"tag":36,"props":63,"children":64},{},[65,67,80,82,90],{"type":40,"value":66},"如果只是单次传输文件，可以考虑使用 ",{"type":35,"tag":68,"props":69,"children":72},"code",{"className":70,"language":71,"style":7},"language-sh shiki shiki-themes catppuccin-latte one-dark-pro","sh",[73],{"type":35,"tag":74,"props":75,"children":77},"span",{"style":76},"--shiki-default:#1E66F5;--shiki-default-font-style:italic;--shiki-dark:#61AFEF;--shiki-dark-font-style:inherit",[78],{"type":40,"value":79},"scp",{"type":40,"value":81}," 或 ",{"type":35,"tag":68,"props":83,"children":84},{"className":70,"language":71,"style":7},[85],{"type":35,"tag":74,"props":86,"children":87},{"style":76},[88],{"type":40,"value":89},"rsync",{"type":40,"value":55},{"type":35,"tag":92,"props":93,"children":95},"pre",{"className":70,"code":94,"language":71,"meta":7,"style":7},"scp -P 22 /path/to/file user@host:/path/to/destination\nrsync -avzP /path/to/file user@host:/path/to/destination\n",[96],{"type":35,"tag":68,"props":97,"children":98},{"__ignoreMap":7},[99,131],{"type":35,"tag":74,"props":100,"children":103},{"class":101,"line":102},"line",1,[104,108,114,120,126],{"type":35,"tag":74,"props":105,"children":106},{"style":76},[107],{"type":40,"value":79},{"type":35,"tag":74,"props":109,"children":111},{"style":110},"--shiki-default:#40A02B;--shiki-dark:#D19A66",[112],{"type":40,"value":113}," -P",{"type":35,"tag":74,"props":115,"children":117},{"style":116},"--shiki-default:#FE640B;--shiki-dark:#D19A66",[118],{"type":40,"value":119}," 22",{"type":35,"tag":74,"props":121,"children":123},{"style":122},"--shiki-default:#40A02B;--shiki-dark:#98C379",[124],{"type":40,"value":125}," /path/to/file",{"type":35,"tag":74,"props":127,"children":128},{"style":122},[129],{"type":40,"value":130}," user@host:/path/to/destination\n",{"type":35,"tag":74,"props":132,"children":134},{"class":101,"line":133},2,[135,139,144,148],{"type":35,"tag":74,"props":136,"children":137},{"style":76},[138],{"type":40,"value":89},{"type":35,"tag":74,"props":140,"children":141},{"style":110},[142],{"type":40,"value":143}," -avzP",{"type":35,"tag":74,"props":145,"children":146},{"style":122},[147],{"type":40,"value":125},{"type":35,"tag":74,"props":149,"children":150},{"style":122},[151],{"type":40,"value":130},{"type":35,"tag":57,"props":153,"children":155},{"id":154},"作为服务器",[156],{"type":40,"value":154},{"type":35,"tag":158,"props":159,"children":161},"h3",{"id":160},"安装和启动-samba-服务",[162],{"type":40,"value":163},"安装和启动 Samba 服务",{"type":35,"tag":92,"props":165,"children":167},{"className":70,"code":166,"language":71,"meta":7,"style":7},"sudo pacman -S samba\nsudo systemctl enable --now smb.service\n",[168],{"type":35,"tag":68,"props":169,"children":170},{"__ignoreMap":7},[171,194],{"type":35,"tag":74,"props":172,"children":173},{"class":101,"line":102},[174,179,184,189],{"type":35,"tag":74,"props":175,"children":176},{"style":76},[177],{"type":40,"value":178},"sudo",{"type":35,"tag":74,"props":180,"children":181},{"style":122},[182],{"type":40,"value":183}," pacman",{"type":35,"tag":74,"props":185,"children":186},{"style":110},[187],{"type":40,"value":188}," -S",{"type":35,"tag":74,"props":190,"children":191},{"style":122},[192],{"type":40,"value":193}," samba\n",{"type":35,"tag":74,"props":195,"children":196},{"class":101,"line":133},[197,201,206,211,216],{"type":35,"tag":74,"props":198,"children":199},{"style":76},[200],{"type":40,"value":178},{"type":35,"tag":74,"props":202,"children":203},{"style":122},[204],{"type":40,"value":205}," systemctl",{"type":35,"tag":74,"props":207,"children":208},{"style":122},[209],{"type":40,"value":210}," enable",{"type":35,"tag":74,"props":212,"children":213},{"style":110},[214],{"type":40,"value":215}," --now",{"type":35,"tag":74,"props":217,"children":218},{"style":122},[219],{"type":40,"value":220}," smb.service\n",{"type":35,"tag":158,"props":222,"children":224},{"id":223},"添加-samba-用户",[225],{"type":40,"value":226},"添加 Samba 用户",{"type":35,"tag":228,"props":229,"children":230},"ul",{},[231,266],{"type":35,"tag":232,"props":233,"children":234},"li",{},[235,237],{"type":40,"value":236},"设置本用户的 SMB 密码：\n",{"type":35,"tag":92,"props":238,"children":240},{"className":70,"code":239,"language":71,"meta":7,"style":7},"sudo smbpasswd -a my_username\n",[241],{"type":35,"tag":68,"props":242,"children":243},{"__ignoreMap":7},[244],{"type":35,"tag":74,"props":245,"children":246},{"class":101,"line":102},[247,251,256,261],{"type":35,"tag":74,"props":248,"children":249},{"style":76},[250],{"type":40,"value":178},{"type":35,"tag":74,"props":252,"children":253},{"style":122},[254],{"type":40,"value":255}," smbpasswd",{"type":35,"tag":74,"props":257,"children":258},{"style":110},[259],{"type":40,"value":260}," -a",{"type":35,"tag":74,"props":262,"children":263},{"style":122},[264],{"type":40,"value":265}," my_username\n",{"type":35,"tag":232,"props":267,"children":268},{},[269,271],{"type":40,"value":270},"如果你需要使用其他账户访问 SMB，请添加对应用户名：\n",{"type":35,"tag":92,"props":272,"children":274},{"className":70,"code":273,"language":71,"meta":7,"style":7},"# 添加用户并阻止此用户登录 shell\nsudo useradd a_smb_guest_name -s /bin/nologin\nsudo smbpasswd -a a_smb_guest_name\n",[275],{"type":35,"tag":68,"props":276,"children":277},{"__ignoreMap":7},[278,287,314],{"type":35,"tag":74,"props":279,"children":280},{"class":101,"line":102},[281],{"type":35,"tag":74,"props":282,"children":284},{"style":283},"--shiki-default:#9CA0B0;--shiki-default-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic",[285],{"type":40,"value":286},"# 添加用户并阻止此用户登录 shell\n",{"type":35,"tag":74,"props":288,"children":289},{"class":101,"line":133},[290,294,299,304,309],{"type":35,"tag":74,"props":291,"children":292},{"style":76},[293],{"type":40,"value":178},{"type":35,"tag":74,"props":295,"children":296},{"style":122},[297],{"type":40,"value":298}," useradd",{"type":35,"tag":74,"props":300,"children":301},{"style":122},[302],{"type":40,"value":303}," a_smb_guest_name",{"type":35,"tag":74,"props":305,"children":306},{"style":110},[307],{"type":40,"value":308}," -s",{"type":35,"tag":74,"props":310,"children":311},{"style":122},[312],{"type":40,"value":313}," /bin/nologin\n",{"type":35,"tag":74,"props":315,"children":317},{"class":101,"line":316},3,[318,322,326,330],{"type":35,"tag":74,"props":319,"children":320},{"style":76},[321],{"type":40,"value":178},{"type":35,"tag":74,"props":323,"children":324},{"style":122},[325],{"type":40,"value":255},{"type":35,"tag":74,"props":327,"children":328},{"style":110},[329],{"type":40,"value":260},{"type":35,"tag":74,"props":331,"children":332},{"style":122},[333],{"type":40,"value":334}," a_smb_guest_name\n",{"type":35,"tag":158,"props":336,"children":338},{"id":337},"配置-samba",[339],{"type":40,"value":340},"配置 Samba",{"type":35,"tag":342,"props":343,"children":344},"alert",{},[345],{"type":35,"tag":36,"props":346,"children":347},{},[348,350,364],{"type":40,"value":349},"请参阅 SMB 默认配置文件 ",{"type":35,"tag":48,"props":351,"children":355},{"href":352,"rel":353},"https://git.samba.org/samba.git/?p=samba.git;a=blob_plain;f=examples/smb.conf.default;hb=HEAD",[354],"nofollow",[356,362],{"type":35,"tag":68,"props":357,"children":359},{"className":358},[],[360],{"type":40,"value":361},"smb.conf",{"type":40,"value":363}," 的官方示例",{"type":40,"value":55},{"type":35,"tag":36,"props":366,"children":367},{},[368],{"type":40,"value":369},"编辑 Samba 配置文件：",{"type":35,"tag":92,"props":371,"children":373},{"className":70,"code":372,"language":71,"meta":7,"style":7},"sudo vim /etc/samba/smb.conf\n",[374],{"type":35,"tag":68,"props":375,"children":376},{"__ignoreMap":7},[377],{"type":35,"tag":74,"props":378,"children":379},{"class":101,"line":102},[380,384,389],{"type":35,"tag":74,"props":381,"children":382},{"style":76},[383],{"type":40,"value":178},{"type":35,"tag":74,"props":385,"children":386},{"style":122},[387],{"type":40,"value":388}," vim",{"type":35,"tag":74,"props":390,"children":391},{"style":122},[392],{"type":40,"value":393}," /etc/samba/smb.conf\n",{"type":35,"tag":36,"props":395,"children":396},{},[397],{"type":40,"value":398},"在配置文件中添加以下内容：",{"type":35,"tag":92,"props":400,"children":404},{"className":401,"code":402,"language":403,"meta":7,"style":7},"language-ini shiki shiki-themes catppuccin-latte one-dark-pro","[global]\n   # 主机名配置\n   netbios name = Arch  # 设置主机名\n\n   # 用户访问配置\n   map to guest = bad user  # 将无效用户映射为 guest\n   guest ok = yes  # 允许 guest 访问\n\n   # 以下是可选项，使用默认值即可：\n   ; workgroup = WORKGROUP  # 默认工作组名称\n   ; server string = Samba Server  # 服务器描述字符串，默认是 \"Samba %v\"\n   ; guest only = no  # 是否只允许 guest 访问，默认是 no\n\n[share_folder_display_name]  # 文件夹共享设置\n   path = /path/to/share  # 指定共享路径\n   valid users = username1 username2  # 允许访问的用户列表\n\n   # 以下是可选项，使用默认值即可：\n   ; comment = Guest Share  # 文件夹的描述，默认是空字符串\n   ; public = yes  # 允许公开访问，通常与 guest ok 配合使用，默认是 no\n   ; browseable = yes  # 共享是否在网络中可见，默认是 yes\n   ; read only = no  # 共享是否只读，默认是 no\n   ; writable = yes  # 共享是否可写，默认与 read only 相反\n   ; guest ok = no  # 是否允许 guest 访问，默认是 no\n\n","ini",[405],{"type":35,"tag":68,"props":406,"children":407},{"__ignoreMap":7},[408,428,436,467,477,486,514,542,550,559,568,577,586,594,617,640,668,676,684,693,702,711,720,729],{"type":35,"tag":74,"props":409,"children":410},{"class":101,"line":102},[411,417,423],{"type":35,"tag":74,"props":412,"children":414},{"style":413},"--shiki-default:#7C7F93;--shiki-dark:#61AFEF",[415],{"type":40,"value":416},"[",{"type":35,"tag":74,"props":418,"children":420},{"style":419},"--shiki-default:#DF8E1D;--shiki-dark:#61AFEF",[421],{"type":40,"value":422},"global",{"type":35,"tag":74,"props":424,"children":425},{"style":413},[426],{"type":40,"value":427},"]\n",{"type":35,"tag":74,"props":429,"children":430},{"class":101,"line":133},[431],{"type":35,"tag":74,"props":432,"children":433},{"style":283},[434],{"type":40,"value":435},"   # 主机名配置\n",{"type":35,"tag":74,"props":437,"children":438},{"class":101,"line":316},[439,445,451,457,462],{"type":35,"tag":74,"props":440,"children":442},{"style":441},"--shiki-default:#4C4F69;--shiki-dark:#98C379",[443],{"type":40,"value":444},"   netbios ",{"type":35,"tag":74,"props":446,"children":448},{"style":447},"--shiki-default:#1E66F5;--shiki-dark:#C678DD",[449],{"type":40,"value":450},"name",{"type":35,"tag":74,"props":452,"children":454},{"style":453},"--shiki-default:#179299;--shiki-dark:#ABB2BF",[455],{"type":40,"value":456}," =",{"type":35,"tag":74,"props":458,"children":459},{"style":441},[460],{"type":40,"value":461}," Arch  ",{"type":35,"tag":74,"props":463,"children":464},{"style":283},[465],{"type":40,"value":466},"# 设置主机名\n",{"type":35,"tag":74,"props":468,"children":470},{"class":101,"line":469},4,[471],{"type":35,"tag":74,"props":472,"children":474},{"emptyLinePlaceholder":473},true,[475],{"type":40,"value":476},"\n",{"type":35,"tag":74,"props":478,"children":480},{"class":101,"line":479},5,[481],{"type":35,"tag":74,"props":482,"children":483},{"style":283},[484],{"type":40,"value":485},"   # 用户访问配置\n",{"type":35,"tag":74,"props":487,"children":489},{"class":101,"line":488},6,[490,495,500,504,509],{"type":35,"tag":74,"props":491,"children":492},{"style":441},[493],{"type":40,"value":494},"   map to ",{"type":35,"tag":74,"props":496,"children":497},{"style":447},[498],{"type":40,"value":499},"guest",{"type":35,"tag":74,"props":501,"children":502},{"style":453},[503],{"type":40,"value":456},{"type":35,"tag":74,"props":505,"children":506},{"style":441},[507],{"type":40,"value":508}," bad user  ",{"type":35,"tag":74,"props":510,"children":511},{"style":283},[512],{"type":40,"value":513},"# 将无效用户映射为 guest\n",{"type":35,"tag":74,"props":515,"children":517},{"class":101,"line":516},7,[518,523,528,532,537],{"type":35,"tag":74,"props":519,"children":520},{"style":441},[521],{"type":40,"value":522},"   guest ",{"type":35,"tag":74,"props":524,"children":525},{"style":447},[526],{"type":40,"value":527},"ok",{"type":35,"tag":74,"props":529,"children":530},{"style":453},[531],{"type":40,"value":456},{"type":35,"tag":74,"props":533,"children":534},{"style":441},[535],{"type":40,"value":536}," yes  ",{"type":35,"tag":74,"props":538,"children":539},{"style":283},[540],{"type":40,"value":541},"# 允许 guest 访问\n",{"type":35,"tag":74,"props":543,"children":545},{"class":101,"line":544},8,[546],{"type":35,"tag":74,"props":547,"children":548},{"emptyLinePlaceholder":473},[549],{"type":40,"value":476},{"type":35,"tag":74,"props":551,"children":553},{"class":101,"line":552},9,[554],{"type":35,"tag":74,"props":555,"children":556},{"style":283},[557],{"type":40,"value":558},"   # 以下是可选项，使用默认值即可：\n",{"type":35,"tag":74,"props":560,"children":562},{"class":101,"line":561},10,[563],{"type":35,"tag":74,"props":564,"children":565},{"style":283},[566],{"type":40,"value":567},"   ; workgroup = WORKGROUP  # 默认工作组名称\n",{"type":35,"tag":74,"props":569,"children":571},{"class":101,"line":570},11,[572],{"type":35,"tag":74,"props":573,"children":574},{"style":283},[575],{"type":40,"value":576},"   ; server string = Samba Server  # 服务器描述字符串，默认是 \"Samba %v\"\n",{"type":35,"tag":74,"props":578,"children":580},{"class":101,"line":579},12,[581],{"type":35,"tag":74,"props":582,"children":583},{"style":283},[584],{"type":40,"value":585},"   ; guest only = no  # 是否只允许 guest 访问，默认是 no\n",{"type":35,"tag":74,"props":587,"children":589},{"class":101,"line":588},13,[590],{"type":35,"tag":74,"props":591,"children":592},{"emptyLinePlaceholder":473},[593],{"type":40,"value":476},{"type":35,"tag":74,"props":595,"children":597},{"class":101,"line":596},14,[598,602,607,612],{"type":35,"tag":74,"props":599,"children":600},{"style":413},[601],{"type":40,"value":416},{"type":35,"tag":74,"props":603,"children":604},{"style":419},[605],{"type":40,"value":606},"share_folder_display_name",{"type":35,"tag":74,"props":608,"children":609},{"style":413},[610],{"type":40,"value":611},"]",{"type":35,"tag":74,"props":613,"children":614},{"style":283},[615],{"type":40,"value":616},"  # 文件夹共享设置\n",{"type":35,"tag":74,"props":618,"children":620},{"class":101,"line":619},15,[621,626,630,635],{"type":35,"tag":74,"props":622,"children":623},{"style":447},[624],{"type":40,"value":625},"   path",{"type":35,"tag":74,"props":627,"children":628},{"style":453},[629],{"type":40,"value":456},{"type":35,"tag":74,"props":631,"children":632},{"style":441},[633],{"type":40,"value":634}," /path/to/share  ",{"type":35,"tag":74,"props":636,"children":637},{"style":283},[638],{"type":40,"value":639},"# 指定共享路径\n",{"type":35,"tag":74,"props":641,"children":643},{"class":101,"line":642},16,[644,649,654,658,663],{"type":35,"tag":74,"props":645,"children":646},{"style":441},[647],{"type":40,"value":648},"   valid ",{"type":35,"tag":74,"props":650,"children":651},{"style":447},[652],{"type":40,"value":653},"users",{"type":35,"tag":74,"props":655,"children":656},{"style":453},[657],{"type":40,"value":456},{"type":35,"tag":74,"props":659,"children":660},{"style":441},[661],{"type":40,"value":662}," username1 username2  ",{"type":35,"tag":74,"props":664,"children":665},{"style":283},[666],{"type":40,"value":667},"# 允许访问的用户列表\n",{"type":35,"tag":74,"props":669,"children":671},{"class":101,"line":670},17,[672],{"type":35,"tag":74,"props":673,"children":674},{"emptyLinePlaceholder":473},[675],{"type":40,"value":476},{"type":35,"tag":74,"props":677,"children":679},{"class":101,"line":678},18,[680],{"type":35,"tag":74,"props":681,"children":682},{"style":283},[683],{"type":40,"value":558},{"type":35,"tag":74,"props":685,"children":687},{"class":101,"line":686},19,[688],{"type":35,"tag":74,"props":689,"children":690},{"style":283},[691],{"type":40,"value":692},"   ; comment = Guest Share  # 文件夹的描述，默认是空字符串\n",{"type":35,"tag":74,"props":694,"children":696},{"class":101,"line":695},20,[697],{"type":35,"tag":74,"props":698,"children":699},{"style":283},[700],{"type":40,"value":701},"   ; public = yes  # 允许公开访问，通常与 guest ok 配合使用，默认是 no\n",{"type":35,"tag":74,"props":703,"children":705},{"class":101,"line":704},21,[706],{"type":35,"tag":74,"props":707,"children":708},{"style":283},[709],{"type":40,"value":710},"   ; browseable = yes  # 共享是否在网络中可见，默认是 yes\n",{"type":35,"tag":74,"props":712,"children":714},{"class":101,"line":713},22,[715],{"type":35,"tag":74,"props":716,"children":717},{"style":283},[718],{"type":40,"value":719},"   ; read only = no  # 共享是否只读，默认是 no\n",{"type":35,"tag":74,"props":721,"children":723},{"class":101,"line":722},23,[724],{"type":35,"tag":74,"props":725,"children":726},{"style":283},[727],{"type":40,"value":728},"   ; writable = yes  # 共享是否可写，默认与 read only 相反\n",{"type":35,"tag":74,"props":730,"children":732},{"class":101,"line":731},24,[733],{"type":35,"tag":74,"props":734,"children":735},{"style":283},[736],{"type":40,"value":737},"   ; guest ok = no  # 是否允许 guest 访问，默认是 no\n",{"type":35,"tag":57,"props":739,"children":741},{"id":740},"作为客户端",[742],{"type":40,"value":740},{"type":35,"tag":744,"props":745,"children":749},"link-card",{"icon":746,"link":747,"title":748},"https://coda.world/favicon.ico","https://coda.world/linux-and-samba-share/","Linux 下访问 Samba 共享的几种姿势",[],{"type":35,"tag":751,"props":752,"children":753},"style",{},[754],{"type":40,"value":755},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":7,"searchDepth":469,"depth":469,"links":757},[758,759,764],{"id":59,"depth":133,"text":59},{"id":154,"depth":133,"text":154,"children":760},[761,762,763],{"id":160,"depth":316,"text":163},{"id":223,"depth":316,"text":226},{"id":337,"depth":316,"text":340},{"id":740,"depth":133,"text":740},"markdown","content:posts:2024:linux-samba.md","content","posts/2024/linux-samba.md","posts/2024/linux-samba","md","/posts",[773,778],{"_path":774,"title":775,"date":776,"type":777},"/2024/all-pits-stepped","从“端口无法访问”到本地环境问题——朋友的博客踩坑记录","2024-07-24T13:20:57.000Z","story",{"_path":779,"title":780,"date":781,"type":777},"/2024/grandma-high-point","祖母的90年代南昌差旅之险","2024-08-24T22:46:54.000Z",1743394803388]