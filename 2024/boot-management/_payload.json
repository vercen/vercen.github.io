[{"data":1,"prerenderedAt":476},["ShallowReactive",2],{"/2024/boot-management":3,"surround-/2024/boot-management":466},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"date":10,"updated":11,"image":12,"categories":13,"tags":15,"readingTime":20,"body":25,"_type":459,"_id":460,"_source":461,"_file":462,"_stem":463,"_extension":464,"_original_dir":465},"/2024/boot-management","2024",false,"","系统引导配置分享","指哪里就启动哪里——在 Windows 和 Linux 系统下实现重启至特定 EFI 引导项。","2024-03-01T06:06:19.000Z","2024-03-01T07:17:30.000Z","https://7.isyangs.cn/24/6664009916cea-24.jpg",[14],"经验分享",[16,17,18,19],"教程","系统","archlinux","Windows",{"text":21,"minutes":22,"time":23,"words":24},"4 min read",3.135,188100,627,{"type":26,"children":27,"toc":447},"root",[28,36,42,47,52,58,65,71,76,86,99,105,342,347,353,358,362,367,375,380,384,390,407,411,416,424,437,441],{"type":29,"tag":30,"props":31,"children":33},"element","h2",{"id":32},"前置知识",[34],{"type":35,"value":32},"text",{"type":29,"tag":37,"props":38,"children":39},"p",{},[40],{"type":35,"value":41},"一般来说，系统引导方式有 Legacy 引导和 UEFI 引导。其中 Legacy 引导方式较为古老，不在本篇文章的讨论范围内。",{"type":29,"tag":37,"props":43,"children":44},{},[45],{"type":35,"value":46},"UEFI 引导中，可以有多个启动项，比如 Windows Boot Manager、Linux Boot Manager、Grub、网络启动、USB设备启动等。",{"type":29,"tag":37,"props":48,"children":49},{},[50],{"type":35,"value":51},"而在诸如 Windows Boot Manager、Linux Boot Manager、Grub 这些启动项管理器中，也可以设置多个启动项。如果安装了多个 Windows 系统，Windows Boot Manager 中会显示多个 Windows 启动项；如果安装了 Linux 系统， Grub 中会显示 Linux 系统、Linux 系统(高级启动)，以及可能会有 Windows Boot Manager 的启动项。",{"type":29,"tag":30,"props":53,"children":55},{"id":54},"windows-下使用脚本重启到其他系统",[56],{"type":35,"value":57},"Windows 下使用脚本重启到其他系统",{"type":29,"tag":59,"props":60,"children":62},"h3",{"id":61},"列出-efi-启动项",[63],{"type":35,"value":64},"列出 EFI 启动项",{"type":29,"tag":66,"props":67,"children":70},"copy",{"code":68,"prompt":69},"bcdedit /enum ALL","PS(管理员)>",[],{"type":29,"tag":37,"props":72,"children":73},{},[74],{"type":35,"value":75},"执行此命令，你会看到类似以下内容：",{"type":29,"tag":77,"props":78,"children":80},"pre",{"code":79},"固件启动管理器\n---------------------\n标识符                  {fwbootmgr}\ndisplayorder            {bootmgr}\n                        {77a0d197-59c5-11ee-b0be-c8cb9e630a73}\n                        {9dda157b-7ef3-11ee-b143-806e6f6e6963}\n                        {f0506e71-9c73-11ed-adf2-806e6f6e6963}\n\nWindows 启动管理器\n--------------------\n标识符                  {bootmgr}\ndevice                  partition=\\Device\\HarddiskVolume1\npath                    \\EFI\\Microsoft\\Boot\\bootmgfw.efi\ndescription             Windows Boot Manager\n\n固件应用程序(101fffff)\n-------------------------------\n标识符                  {77a0d197-59c5-11ee-b0be-c8cb9e630a73}\ndevice                  partition=\\Device\\HarddiskVolume1\npath                    \\EFI\\systemd\\systemd-bootx64.efi\ndescription             Linux Boot Manager\n\n固件应用程序(101fffff)\n-------------------------------\n标识符                  {9dda157b-7ef3-11ee-b143-806e6f6e6963}\ndevice                  partition=\\Device\\HarddiskVolume6\npath                    \\EFI\\Microsoft\\Boot\\bootmgfw.efi\ndescription             Windows Boot Manager\n\n固件应用程序(101fffff)\n-------------------------------\n标识符                  {f0506e71-9c73-11ed-adf2-806e6f6e6963}\ndescription             EFI USB Device\n\nWindows 启动加载器\n-------------------\n标识符                  {current}\ndevice                  partition=C:\npath                    \\WINDOWS\\system32\\winload.efi\ndescription             Windows 11\n\n……\n",[81],{"type":29,"tag":82,"props":83,"children":84},"code",{"__ignoreMap":7},[85],{"type":35,"value":79},{"type":29,"tag":37,"props":87,"children":88},{},[89,91,97],{"type":35,"value":90},"记住你需要重启到的、形如 ",{"type":29,"tag":82,"props":92,"children":94},{"className":93},[],[95],{"type":35,"value":96},"{77a0d197-59c5-11ee-b0be-c8cb9e630a73}",{"type":35,"value":98}," 的 UUID，就可以编写脚本了。",{"type":29,"tag":59,"props":100,"children":102},{"id":101},"重启到指定-efi-启动项",[103],{"type":35,"value":104},"重启到指定 EFI 启动项",{"type":29,"tag":77,"props":106,"children":111},{"code":107,"filename":108,"language":109,"meta":7,"className":110,"style":7},"rem 使用管理员权限运行此脚本\n%1 mshta vbscript:CreateObject(\"Shell.Application\").ShellExecute(\"cmd\",\"/c %~s0 ::\",\"\",\"runas\",1)(window.close) && exit\nrem 将 Linux Boot Manager 设置为下次启动项\nbcdedit /set \"{fwbootmgr}\" bootsequence \"{77a0d197-59c5-11ee-b0be-c8cb9e630a73}\" /addfirst\nrem 重启\nshutdown -r -t 0\n","reboot-to-some-entry.bat","bat","language-bat shiki shiki-themes catppuccin-latte one-dark-pro",[112],{"type":29,"tag":82,"props":113,"children":114},{"__ignoreMap":7},[115,133,262,275,309,322],{"type":29,"tag":116,"props":117,"children":120},"span",{"class":118,"line":119},"line",1,[121,127],{"type":29,"tag":116,"props":122,"children":124},{"style":123},"--shiki-default:#8839EF;--shiki-default-font-style:inherit;--shiki-dark:#C678DD;--shiki-dark-font-style:italic",[125],{"type":35,"value":126},"rem",{"type":29,"tag":116,"props":128,"children":130},{"style":129},"--shiki-default:#9CA0B0;--shiki-default-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic",[131],{"type":35,"value":132}," 使用管理员权限运行此脚本\n",{"type":29,"tag":116,"props":134,"children":136},{"class":118,"line":135},2,[137,143,149,155,161,167,172,177,181,186,191,196,200,205,210,214,219,223,228,232,236,241,246,250,256],{"type":29,"tag":116,"props":138,"children":140},{"style":139},"--shiki-default:#4C4F69;--shiki-default-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic",[141],{"type":35,"value":142},"%",{"type":29,"tag":116,"props":144,"children":146},{"style":145},"--shiki-default:#E64553;--shiki-default-font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic",[147],{"type":35,"value":148},"1",{"type":29,"tag":116,"props":150,"children":152},{"style":151},"--shiki-default:#4C4F69;--shiki-dark:#ABB2BF",[153],{"type":35,"value":154}," mshta vbscript:CreateObject",{"type":29,"tag":116,"props":156,"children":158},{"style":157},"--shiki-default:#7C7F93;--shiki-dark:#ABB2BF",[159],{"type":35,"value":160},"(",{"type":29,"tag":116,"props":162,"children":164},{"style":163},"--shiki-default:#40A02B;--shiki-dark:#98C379",[165],{"type":35,"value":166},"\"Shell.Application\"",{"type":29,"tag":116,"props":168,"children":169},{"style":157},[170],{"type":35,"value":171},")",{"type":29,"tag":116,"props":173,"children":174},{"style":151},[175],{"type":35,"value":176},".ShellExecute",{"type":29,"tag":116,"props":178,"children":179},{"style":157},[180],{"type":35,"value":160},{"type":29,"tag":116,"props":182,"children":183},{"style":163},[184],{"type":35,"value":185},"\"cmd\"",{"type":29,"tag":116,"props":187,"children":188},{"style":157},[189],{"type":35,"value":190},",",{"type":29,"tag":116,"props":192,"children":193},{"style":163},[194],{"type":35,"value":195},"\"/c ",{"type":29,"tag":116,"props":197,"children":198},{"style":139},[199],{"type":35,"value":142},{"type":29,"tag":116,"props":201,"children":202},{"style":145},[203],{"type":35,"value":204},"~s0",{"type":29,"tag":116,"props":206,"children":207},{"style":163},[208],{"type":35,"value":209}," ::\"",{"type":29,"tag":116,"props":211,"children":212},{"style":157},[213],{"type":35,"value":190},{"type":29,"tag":116,"props":215,"children":216},{"style":163},[217],{"type":35,"value":218},"\"\"",{"type":29,"tag":116,"props":220,"children":221},{"style":157},[222],{"type":35,"value":190},{"type":29,"tag":116,"props":224,"children":225},{"style":163},[226],{"type":35,"value":227},"\"runas\"",{"type":29,"tag":116,"props":229,"children":230},{"style":157},[231],{"type":35,"value":190},{"type":29,"tag":116,"props":233,"children":234},{"style":151},[235],{"type":35,"value":148},{"type":29,"tag":116,"props":237,"children":238},{"style":157},[239],{"type":35,"value":240},")(",{"type":29,"tag":116,"props":242,"children":243},{"style":151},[244],{"type":35,"value":245},"window.close",{"type":29,"tag":116,"props":247,"children":248},{"style":157},[249],{"type":35,"value":171},{"type":29,"tag":116,"props":251,"children":253},{"style":252},"--shiki-default:#179299;--shiki-dark:#ABB2BF",[254],{"type":35,"value":255}," &&",{"type":29,"tag":116,"props":257,"children":259},{"style":258},"--shiki-default:#8839EF;--shiki-dark:#C678DD",[260],{"type":35,"value":261}," exit\n",{"type":29,"tag":116,"props":263,"children":265},{"class":118,"line":264},3,[266,270],{"type":29,"tag":116,"props":267,"children":268},{"style":123},[269],{"type":35,"value":126},{"type":29,"tag":116,"props":271,"children":272},{"style":129},[273],{"type":35,"value":274}," 将 Linux Boot Manager 设置为下次启动项\n",{"type":29,"tag":116,"props":276,"children":278},{"class":118,"line":277},4,[279,284,289,294,299,304],{"type":29,"tag":116,"props":280,"children":281},{"style":258},[282],{"type":35,"value":283},"bcdedit",{"type":29,"tag":116,"props":285,"children":286},{"style":151},[287],{"type":35,"value":288}," /set ",{"type":29,"tag":116,"props":290,"children":291},{"style":163},[292],{"type":35,"value":293},"\"{fwbootmgr}\"",{"type":29,"tag":116,"props":295,"children":296},{"style":151},[297],{"type":35,"value":298}," bootsequence ",{"type":29,"tag":116,"props":300,"children":301},{"style":163},[302],{"type":35,"value":303},"\"{77a0d197-59c5-11ee-b0be-c8cb9e630a73}\"",{"type":29,"tag":116,"props":305,"children":306},{"style":151},[307],{"type":35,"value":308}," /addfirst\n",{"type":29,"tag":116,"props":310,"children":312},{"class":118,"line":311},5,[313,317],{"type":29,"tag":116,"props":314,"children":315},{"style":123},[316],{"type":35,"value":126},{"type":29,"tag":116,"props":318,"children":319},{"style":129},[320],{"type":35,"value":321}," 重启\n",{"type":29,"tag":116,"props":323,"children":325},{"class":118,"line":324},6,[326,331,336],{"type":29,"tag":116,"props":327,"children":328},{"style":258},[329],{"type":35,"value":330},"shutdown",{"type":29,"tag":116,"props":332,"children":333},{"style":151},[334],{"type":35,"value":335}," -r -t ",{"type":29,"tag":116,"props":337,"children":339},{"style":338},"--shiki-default:#FE640B;--shiki-dark:#D19A66",[340],{"type":35,"value":341},"0\n",{"type":29,"tag":37,"props":343,"children":344},{},[345],{"type":35,"value":346},"推荐将脚本放在用户文件夹下，因为这是终端启动、SSH连接时的默认目录，输入文件名即可运行。",{"type":29,"tag":30,"props":348,"children":350},{"id":349},"在-linux-下重启到其他系统",[351],{"type":35,"value":352},"在 Linux 下重启到其他系统",{"type":29,"tag":59,"props":354,"children":356},{"id":355},"列出启动项",[357],{"type":35,"value":355},{"type":29,"tag":66,"props":359,"children":361},{"code":360},"efibootmgr",[],{"type":29,"tag":37,"props":363,"children":364},{},[365],{"type":35,"value":366},"执行此命令后，会得到如下所示的 EFI 启动项列表：",{"type":29,"tag":77,"props":368,"children":370},{"code":369},"BootCurrent: 0005\nBootOrder: 0001,0005,0004,2001\nBoot0001* Windows Boot Manager  HD(1,GPT,04f43acd-5a75-4946-b8eb-8c2b4aa000c3,0x800,0x100000)/\\EFI\\Microsoft\\Boot\\bootmgfw.efi\nBoot0004* Windows Boot Manager  HD(1,GPT,3f296803-1e98-4d7f-b76b-263785c2dcef,0x28,0x100000)/\\EFI\\Microsoft\\Boot\\bootmgfw.efi\nBoot0005* Linux Boot Manager    HD(1,GPT,04f43acd-5a75-4946-b8eb-8c2b4aa000c3,0x800,0x100000)/\\EFI\\systemd\\systemd-bootx64.efi\nBoot2001* EFI USB Device        RC\n",[371],{"type":29,"tag":82,"props":372,"children":373},{"__ignoreMap":7},[374],{"type":35,"value":369},{"type":29,"tag":59,"props":376,"children":378},{"id":377},"重启到指定-efi-启动项-1",[379],{"type":35,"value":104},{"type":29,"tag":66,"props":381,"children":383},{"code":382},"sudo efibootmgr -n 四位数序号",[],{"type":29,"tag":59,"props":385,"children":387},{"id":386},"修改-linux-boot-manager-的下一次启动项默认启动项",[388],{"type":35,"value":389},"修改 Linux Boot Manager 的下一次启动项/默认启动项",{"type":29,"tag":391,"props":392,"children":393},"blockquote",{},[394],{"type":29,"tag":37,"props":395,"children":396},{},[397,399,405],{"type":35,"value":398},"仅适用于使用 ",{"type":29,"tag":82,"props":400,"children":402},{"className":401},[],[403],{"type":35,"value":404},"systemd-boot",{"type":35,"value":406}," 启动的系统，如果你在使用 Grub，请参阅其他教程。",{"type":29,"tag":66,"props":408,"children":410},{"code":409},"bootctl list",[],{"type":29,"tag":37,"props":412,"children":413},{},[414],{"type":35,"value":415},"执行此命令后，可以列出如下所示的启动项列表：",{"type":29,"tag":77,"props":417,"children":419},{"code":418},"         type: Boot Loader Specification Type #1 (.conf)\n        title: Arch Linux (default) (selected)\n           id: 10-arch.conf\n       source: /boot//loader/entries/10-arch.conf\n        linux: /boot//vmlinuz-linux\n       initrd: /boot//amd-ucode.img\n               /boot//initramfs-linux.img\n      options: root=PARTUUID=7227604a-aca1-034d-9bd3-e17d53548a62 rw rootfstype=btrfs\n\n         type: Automatic\n        title: Windows Boot Manager\n           id: auto-windows\n       source: /sys/firmware/efi/efivars/LoaderEntries-4a67b082-0a4c-41cf-b6c7-440b29bb8c4f\n\n         type: Automatic\n        title: Reboot Into Firmware Interface\n           id: auto-reboot-to-firmware-setup\n       source: /sys/firmware/efi/efivars/LoaderEntries-4a67b082-0a4c-41cf-b6c7-440b29bb8c4f\n",[420],{"type":29,"tag":82,"props":421,"children":422},{"__ignoreMap":7},[423],{"type":35,"value":418},{"type":29,"tag":37,"props":425,"children":426},{},[427,429,435],{"type":35,"value":428},"使用此命令可以修改 Linux Boot Manager 的下一次启动项，若想修改默认启动项，请使用 ",{"type":29,"tag":82,"props":430,"children":432},{"className":431},[],[433],{"type":35,"value":434},"set-dafault",{"type":35,"value":436}," 选项。",{"type":29,"tag":66,"props":438,"children":440},{"code":439},"sudo bootctl set-oneshot [ID]",[],{"type":29,"tag":442,"props":443,"children":444},"style",{},[445],{"type":35,"value":446},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":7,"searchDepth":277,"depth":277,"links":448},[449,450,454],{"id":32,"depth":135,"text":32},{"id":54,"depth":135,"text":57,"children":451},[452,453],{"id":61,"depth":264,"text":64},{"id":101,"depth":264,"text":104},{"id":349,"depth":135,"text":352,"children":455},[456,457,458],{"id":355,"depth":264,"text":355},{"id":377,"depth":264,"text":104},{"id":386,"depth":264,"text":389},"markdown","content:posts:2024:boot-management.md","content","posts/2024/boot-management.md","posts/2024/boot-management","md","/posts",[467,471],{"_path":468,"title":469,"date":470},"/2024/virus-trueupdate","病毒高占用CPU，三天杀俩","2024-02-29T15:54:43.000Z",{"_path":472,"title":473,"date":474,"type":475},"/2024/helping-day","今日无事，除了一些技术咨询","2024-03-10T13:14:38.000Z","story",1743402690902]